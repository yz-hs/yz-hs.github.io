<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="msvalidate.01" content="A7B4DB5A7BF5E5C6E52E34BB024D6319"><meta name="description" content="本站为 Yurchiu 用来记录 OI、笔记、感想的 Blog，欢迎来到本博客！希望我们能相互交流，共同进步～"><meta http-equiv="content-language" content="zh-cn"><title>并查集 2 | Yurchiu's Blog</title><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.4.17/sweetalert2.all.min.js"></script><script src="https://cdn.staticfile.org/sketch.js/1.0/sketch.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/chaffle.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/main.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/search.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/initial.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.6/katex.min.css"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/vs2015.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/css/style.css"><link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Yurchiu's Blog" type="application/atom+xml"></head><body style="background-image:url(https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-bgp.png)"><div id="YurLoading" class="YurLoading"><div class="inner"><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div></div></div><div class="topbar"><a onclick="topbarToggle()" class="topbar-menu" style="cursor:pointer"><i class="fa fa-bars"></i> </a><a href="/" class="topbar-title"><i class="fa fa-home"></i> Yurchiu's Blog </a><a target="_blank" rel="noopener" href="https://github.com/yz-hs" class="topbar-title"><i class="fa fa-github"></i></a></div><div id="article-container"><div class="sidebar"><div class="avatar-container"><img src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-avatar.jpg" class="avatar revolve"></div><div class="sidebar-author">Yurchiu<br><span class="mini-text">An AFO whker.</span></div><div class="sidebar-list-container"><div style="height:10px"></div><a class="list-group-item" href="/"><div><i class="fa fa-home fa-fw"></i>&nbsp; 首页</div><div class="badge"></div></a><a class="list-group-item" href="/archives/"><div><i class="fa fa-tasks fa-fw"></i>&nbsp; 归档</div><div class="badge">158</div></a><a class="list-group-item" href="/tags/"><div><i class="fa fa-tags fa-fw"></i>&nbsp; 标签</div><div class="badge">81</div></a><a class="list-group-item" href="/categories/"><div><i class="fa fa-th-large fa-fw"></i>&nbsp; 分类</div><div class="badge">24</div></a><a class="list-group-item" href="/somepage/mood/"><div><i class="fa fa-photo fa-fw"></i>&nbsp; 说说</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/about/"><div><i class="fa fa-user-o fa-fw"></i>&nbsp; 关于</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/chat/"><div><i class="fa fa-commenting-o fa-fw"></i>&nbsp; 留言</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/link/"><div><i class="fa fa-link fa-fw"></i>&nbsp; 链接</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/settings/"><div><i class="fa fa-cog fa-fw"></i>&nbsp; 设置</div><div class="badge"></div></a><div style="height:200px"></div></div><div class="sidebar-footer"><div class="item" id="back2Top" data-bs-toggle="tooltip" title="顶部"><i class="fa fa-arrow-circle-up"></i></div><div class="item" id="back2Down" data-bs-toggle="tooltip" title="底部"><i class="fa fa-arrow-circle-down"></i></div><div class="item" data-bs-toggle="tooltip" title="RSS"><a href="/atom.xml"><i class="fa fa-feed"></i></a></div><div class="item" data-bs-toggle="tooltip" title="搜索"><a href="/somepage/search/"><i class="fa fa-search"></i></a></div></div></div><div class="article"><div class="vertical fake-sidebar"></div><div class="vertical post"><div class="header"><h1 class="title">并查集 2</h1><div class="meta"><span><i class="fa fa-user-o"></i> Yurchiu </span><span><i class="fa fa-clock-o"></i> 2021-02-22, 09:34:42</span> <span><i class="fa fa-font"></i> 3.4k</span> <span class="hideBars" onclick="hideBars()"><i class="fa fa-eye-slash"></i> 隐藏左右两栏 </span><span class="showBars" onclick="showBars()"><i class="fa fa-eye"></i> 展示左右两栏</span></div></div><div class="breadcrumb"><div class="url"><a href="/"><i class="fa fa-home"></i> 首页</a> / 并查集 2</div><div class="share">分享到 <a target="_blank" rel="noopener" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://yz-hs.github.io/fb7ca72a2695/&title=并查集 2&site=https://yz-hs.github.io"><i class="fa fa-qq"></i></a></div></div><div class="post-text"><p>本文主要以题解为主。以“关押罪犯”为例介绍并查集的用法。</p><h1 id="p1525-noip2010-提高组-关押罪犯"><a class="markdownIt-Anchor" href="#p1525-noip2010-提高组-关押罪犯"></a> P1525 [NOIP2010 提高组] 关押罪犯</h1><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">2\times 10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span> 个罪犯，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span> 个仇恨关系，使用分在两个监狱的方式，使得最大仇恨值最小。</p><h1 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h1><h2 id="二分答案二分染色"><a class="markdownIt-Anchor" href="#二分答案二分染色"></a> 二分答案+二分染色</h2><p><s>似乎和并查集无关呢。</s></p><p>单调性分析：屏蔽的边越多，越容易交替染色，反之越难交替染色成功（类似二分图染色）。</p><p>对边权排个序，进行二分，染色时若当前边权大于等于 mid 才继续染色。</p><p>若染色成功，更新答案。</p><p>代码见命名空间 2。</p><h2 id="并查集法适用范围小"><a class="markdownIt-Anchor" href="#并查集法适用范围小"></a> 并查集法（适用范围小）</h2><p>贪心，对边权从大到小排序，枚举边时第一个矛盾不可调和的边的权即为题目所求。若根据前面的关系，x 和 y 在同一集合（是朋友），而当前边连接了 x 和 y（x 和 y 是敌人），则此矛盾不可调和。</p><p>枚举边时，使用一个数组 <code>enemy[]</code> 记录每个人的敌人。如果已记录，直接合并 x 和 <code>enemy[y]</code> ，以及 y 和 <code>enemy[x]</code>（敌人的敌人即是我的朋友）。</p><p>代码见命名空间 3。</p><h2 id="扩展域并查集"><a class="markdownIt-Anchor" href="#扩展域并查集"></a> 扩展域并查集</h2><p>扩展域并查集可以维护多组关系，适用于有多组关系需要用并查集维护的题目，并且可以不用推像带权并查集那样繁琐的式子。其主要思想是将一个点拆分成好几个点来维护多组关系。</p><p>这类题目只要找准题目中有几组关系，把握住，我的敌人的敌人就是我的朋友的原则（大部分题满足，可能有少部分题不满足这个原则，注意分析）。</p><p>本题目可设置两个域。一个表示“朋友”关系，另一个表示“敌人”关系。</p><p>仍按贪心法枚举。每次合并 x 和 y 的敌人域 ，以及 y 和 x 的敌人域。</p><p>“敌人域”的实现：设 x 和 x+n 是敌人，那么 x+n 和 y 就是朋友了。</p><p>代码见命名空间 1。</p><h2 id="带权并查集"><a class="markdownIt-Anchor" href="#带权并查集"></a> 带权并查集</h2><p>并查集的边加入权以维护集合间的关系。</p><p>我们让并查集中，若两点距离为偶数，则两点是朋友；若两点距离为奇数，则两点是敌人。</p><p><img src="https://cdn.jsdelivr.net/gh/yz-hs/PicGo/%E5%B9%B6%E6%9F%A5%E9%9B%86%20(1).png" alt=""></p><p>如图，以 1 为参照，1 和 2 为朋友，1 和 4 敌对，1 和 3 为朋友。</p><p>现在，要解决合并的问题。</p><p><img src="https://cdn.jsdelivr.net/gh/yz-hs/PicGo/%E5%B9%B6%E6%9F%A5%E9%9B%86%20(2).png" alt=""></p><p>如图，以 1 为参照（根节点），现在要将 4 所在集合合并到 2 所在集合上（3 是 4 的祖先）。若使 2 和 4 为敌人（合并 2 和 4），如何处理？</p><p>我们设一个点距离<strong>父亲</strong>的距离为 <code>dis[i]</code>。要使 2 和 4 为敌人，则合并后的 2 到根节点的距离和 4 到根节点的距离必定奇偶性不同。我们在合并时要求 <code>dis[3]</code>。</p><p>根据以上我们可以得到：<code>dis[2]=dis[3]+dis[4]+1</code>（加一减一无所谓）。移一下项得：<code>dis[3]=dis[4]-dis[2]-1</code>。这个过程在合并中处理。</p><p>还有路径压缩的问题。若使用递归写法，我们可以在递归返回途中，对 dis 值进行更新（累加 &amp; 取模）。</p><p>代码见命名空间 4。</p><h1 id="代码"><a class="markdownIt-Anchor" href="#代码"></a> 代码</h1><details><summary>点击查看</summary><pre class="highlight"><code class="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
<span class="hljs-keyword">namespace</span> _yz1<span class="hljs-comment">//扩展域并查集</span>
&#123;
	<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">20000</span>+<span class="hljs-number">10</span>,M=<span class="hljs-number">100000</span>+<span class="hljs-number">10</span>;
	<span class="hljs-type">int</span> n,m,dad[N*<span class="hljs-number">2</span>];
	<span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;<span class="hljs-type">int</span> fir,sec,len;&#125;e[M];
	<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(edge x,edge y)</span></span>&#123;<span class="hljs-keyword">return</span> x.len&gt;y.len;&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">start</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
	</span>&#123;
    	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
       		dad[i]=i;
   		<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>
	</span>&#123;   
    	<span class="hljs-keyword">while</span>(x!=dad[x])
        	x=dad[x]=dad[dad[x]];
    	<span class="hljs-keyword">return</span> x;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span>
	</span>&#123;
    	<span class="hljs-type">int</span> d1=<span class="hljs-built_in">find</span>(x),d2=<span class="hljs-built_in">find</span>(y);
    	dad[d1]=d2;
    	<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;e[i].fir,&amp;e[i].sec,&amp;e[i].len);
		<span class="hljs-built_in">sort</span>(e+<span class="hljs-number">1</span>,e+<span class="hljs-number">1</span>+m,cmp);<span class="hljs-built_in">start</span>(n*<span class="hljs-number">2</span>);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
		&#123;
			<span class="hljs-type">int</span> d1=e[i].fir,d2=e[i].sec;
			<span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(d1)==<span class="hljs-built_in">find</span>(d2)) &#123;<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,e[i].len);<span class="hljs-keyword">return</span>;&#125;
			<span class="hljs-keyword">else</span> &#123;
				<span class="hljs-built_in">union_</span>(d1,d2+n);
				<span class="hljs-built_in">union_</span>(d2,d1+n);
			&#125;
		&#125;
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0\n&quot;</span>);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;
<span class="hljs-keyword">namespace</span> _yz2<span class="hljs-comment">//二分图染色+二分答案</span>
&#123;
	<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">20000</span>+<span class="hljs-number">10</span>,M=<span class="hljs-number">100000</span>+<span class="hljs-number">10</span>;
	<span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;<span class="hljs-type">int</span> nxt,to,len;&#125;e[M*<span class="hljs-number">2</span>];
	<span class="hljs-type">int</span> n,m,head[N],cnt=<span class="hljs-number">0</span>,ans,v[N],val[M];
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y,<span class="hljs-type">int</span> len)</span></span>&#123;e[++cnt]=(edge)&#123;head[x],y,len&#125;;head[x]=cnt;&#125;
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> now,<span class="hljs-type">int</span> color,<span class="hljs-type">int</span> con)</span>
	</span>&#123;
		<span class="hljs-type">int</span> ret=<span class="hljs-number">0</span>;
		<span class="hljs-keyword">if</span>(v[now]!=<span class="hljs-number">-1</span> &amp;&amp; color!=v[now]) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(v[now]!=<span class="hljs-number">-1</span> &amp;&amp; color==v[now]) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
		v[now]=color;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=head[now];i;i=e[i].nxt)
		&#123;
			<span class="hljs-type">int</span> to=e[i].to;
			<span class="hljs-keyword">if</span>(e[i].len&gt;con)  ret=<span class="hljs-built_in">max</span>(<span class="hljs-built_in">dfs</span>(to,color^<span class="hljs-number">1</span>,con),ret);
		&#125;
		<span class="hljs-keyword">return</span> ret;
	&#125;
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-type">int</span> mid)</span>
	</span>&#123;
		<span class="hljs-type">int</span> ret=<span class="hljs-number">0</span>;
		<span class="hljs-built_in">memset</span>(v,<span class="hljs-number">-1</span>,<span class="hljs-built_in">sizeof</span>(v));
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
			<span class="hljs-keyword">if</span>(v[i]==<span class="hljs-number">-1</span>) ret=<span class="hljs-built_in">max</span>(<span class="hljs-built_in">dfs</span>(i,<span class="hljs-number">1</span>,mid),ret);
		<span class="hljs-keyword">return</span> ret;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-type">int</span> t1,t2,t3,l=<span class="hljs-number">0</span>,r,mid;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);r=m;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
		&#123;
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;t1,&amp;t2,&amp;t3);
			<span class="hljs-built_in">add</span>(t1,t2,t3);
			<span class="hljs-built_in">add</span>(t2,t1,t3);
			val[++val[m+<span class="hljs-number">5</span>]]=t3;
		&#125;
		<span class="hljs-built_in">sort</span>(val+<span class="hljs-number">1</span>,val+<span class="hljs-number">1</span>+m);
		<span class="hljs-keyword">while</span>(l&lt;=r)
		&#123;
			mid=(l+r)/<span class="hljs-number">2</span>;
			<span class="hljs-keyword">if</span>(<span class="hljs-built_in">check</span>(val[mid])) l=mid+<span class="hljs-number">1</span>;
			<span class="hljs-keyword">else</span> ans=val[mid],r=mid<span class="hljs-number">-1</span>;
		&#125;
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,ans);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;
<span class="hljs-keyword">namespace</span> _yz3<span class="hljs-comment">//并查集</span>
&#123;
	<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">20000</span>+<span class="hljs-number">10</span>,M=<span class="hljs-number">100000</span>+<span class="hljs-number">10</span>;
	<span class="hljs-type">int</span> n,m,dad[N],enemy[N];
	<span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;<span class="hljs-type">int</span> fir,sec,len;&#125;e[M];
	<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(edge x,edge y)</span></span>&#123;<span class="hljs-keyword">return</span> x.len&gt;y.len;&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">start</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
	</span>&#123;
    	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
       		dad[i]=i;
   		<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>
	</span>&#123;   
    	<span class="hljs-keyword">while</span>(x!=dad[x])
        	x=dad[x]=dad[dad[x]];
    	<span class="hljs-keyword">return</span> x;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span>
	</span>&#123;
    	<span class="hljs-type">int</span> d1=<span class="hljs-built_in">find</span>(x),d2=<span class="hljs-built_in">find</span>(y);
    	dad[d1]=d2;
    	<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;e[i].fir,&amp;e[i].sec,&amp;e[i].len);
		<span class="hljs-built_in">sort</span>(e+<span class="hljs-number">1</span>,e+<span class="hljs-number">1</span>+m,cmp);<span class="hljs-built_in">start</span>(n);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
		&#123;
			<span class="hljs-type">int</span> d1=e[i].fir,d2=e[i].sec;
			<span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(d1)==<span class="hljs-built_in">find</span>(d2)) &#123;<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,e[i].len);<span class="hljs-keyword">return</span>;&#125;
			<span class="hljs-keyword">else</span> &#123;
				<span class="hljs-keyword">if</span>(!enemy[d2]) enemy[d2]=d1; <span class="hljs-keyword">else</span> <span class="hljs-built_in">union_</span>(d1,enemy[d2]);
				<span class="hljs-keyword">if</span>(!enemy[d1]) enemy[d1]=d2; <span class="hljs-keyword">else</span> <span class="hljs-built_in">union_</span>(d2,enemy[d1]);
			&#125;
		&#125;
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0\n&quot;</span>);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;
<span class="hljs-keyword">namespace</span> _yz4<span class="hljs-comment">//带权并查集</span>
&#123;
	<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">20000</span>+<span class="hljs-number">10</span>,M=<span class="hljs-number">100000</span>+<span class="hljs-number">10</span>;
	<span class="hljs-type">int</span> n,m,dad[N],dis[N];
	<span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;<span class="hljs-type">int</span> fir,sec,len;&#125;e[M];
	<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(edge x,edge y)</span></span>&#123;<span class="hljs-keyword">return</span> x.len&gt;y.len;&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">start</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
	</span>&#123;
    	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
       		dad[i]=i;
   		<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>
	</span>&#123;
		<span class="hljs-type">int</span> ret;<span class="hljs-comment">//注意细节。</span>
   		<span class="hljs-keyword">if</span>(dad[x]==x)
        	<span class="hljs-keyword">return</span> dad[x];
		ret=<span class="hljs-built_in">find</span>(dad[x]);
		dis[x]=(dis[x]+dis[dad[x]])%<span class="hljs-number">2</span>;
    	<span class="hljs-keyword">return</span> dad[x]=ret;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span>
	</span>&#123;
    	<span class="hljs-type">int</span> d1=<span class="hljs-built_in">find</span>(x),d2=<span class="hljs-built_in">find</span>(y);
		dis[d1]=((dis[x]-dis[y]<span class="hljs-number">-1</span>)%<span class="hljs-number">2</span>+<span class="hljs-number">2</span>)%<span class="hljs-number">2</span>;<span class="hljs-comment">//将 dis 值变为在模 2 意义下最小的非负整数。</span>
    	dad[d1]=d2;
		<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;e[i].fir,&amp;e[i].sec,&amp;e[i].len);
		<span class="hljs-built_in">sort</span>(e+<span class="hljs-number">1</span>,e+<span class="hljs-number">1</span>+m,cmp);<span class="hljs-built_in">start</span>(n);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
		&#123;
			<span class="hljs-type">int</span> d1=e[i].fir,d2=e[i].sec;
			<span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(d1)==<span class="hljs-built_in">find</span>(d2) &amp;&amp; dis[d1]%<span class="hljs-number">2</span>==dis[d2]%<span class="hljs-number">2</span>)
			&#123;<span class="hljs-comment">//一定注意 if 判断中的语句先后问题。先 find 保证后面的 dis 的值成为了一个点到根节点的距离。</span>
				<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,e[i].len);
				<span class="hljs-keyword">return</span>;
			&#125;
			<span class="hljs-built_in">union_</span>(d1,d2);	
		&#125;
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0\n&quot;</span>);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>&#123;
	<span class="hljs-comment">//freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);</span>
	<span class="hljs-comment">//freopen(&quot;out.txt&quot;,&quot;w&quot;,stdout);</span>
	_yzCE::<span class="hljs-built_in">yzmain</span>();
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;

</code></pre></details><h1 id="其他题目"><a class="markdownIt-Anchor" href="#其他题目"></a> 其他题目</h1><h2 id="p2024-noi2001-食物链"><a class="markdownIt-Anchor" href="#p2024-noi2001-食物链"></a> P2024 [NOI2001] 食物链</h2><h3 id="题意"><a class="markdownIt-Anchor" href="#题意"></a> 题意</h3><p>动物王国中有三类动物 A，B，C，这三类动物的食物链构成了有趣的环形。A 吃 B，B 吃 C，C 吃 A。</p><p>现有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> 个动物，以 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1-N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> 编号。每个动物都是 A，B，C 中的一种，但是我们并不知道它到底是哪一种。</p><p>有人用两种说法对这 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> 个动物所构成的食物链关系进行描述：</p><ul><li>第一种说法是 <code>1 X Y</code>，表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07847em">X</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.22222em">Y</span></span></span></span> 是同类。</li><li>第二种说法是 <code>2 X Y</code>，表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07847em">X</span></span></span></span> 吃 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.22222em">Y</span></span></span></span>。</li></ul><p>此人对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> 个动物，用上述两种说法，一句接一句地说出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> 句话，这 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> 句话有的是真的，有的是假的。当一句话满足下列三条之一时，这句话就是假话，否则就是真话。</p><ul><li>当前的话与前面的某些真的话冲突，就是假话</li><li>当前的话中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07847em">X</span></span></span></span> 或 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.22222em">Y</span></span></span></span> 比 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> 大，就是假话</li><li>当前的话表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07847em">X</span></span></span></span> 吃 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07847em">X</span></span></span></span>，就是假话</li></ul><p>你的任务是根据给定的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> 句话，输出假话的总数。</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>N</mi><mo>≤</mo><mn>5</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">1\le N\le 5\times10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78041em;vertical-align:-.13597em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8193em;vertical-align:-.13597em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">5</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>K</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">1\le K\le 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78041em;vertical-align:-.13597em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8193em;vertical-align:-.13597em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span>。</p><details><summary>点击查看题解</summary><h3 id="题解-2"><a class="markdownIt-Anchor" href="#题解-2"></a> 题解</h3><h4 id="扩展域并查集-2"><a class="markdownIt-Anchor" href="#扩展域并查集-2"></a> 扩展域并查集</h4><p>本题目可设置三个域。代码见命名空间 1，详情见注释。</p><h4 id="带权并查集-2"><a class="markdownIt-Anchor" href="#带权并查集-2"></a> 带权并查集</h4><p>我们设两点之间的距离 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mn>3</mn></mrow><annotation encoding="application/x-tex">\bmod 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.05555555555555555em"></span><span class="mord">3</span></span></span></span> 的值是被吃关系（仍以根节点为参照；x 的距离比 y 的距离大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，则 x 吃 y ）。</p><p><img src="https://cdn.jsdelivr.net/gh/yz-hs/PicGo/%E5%B9%B6%E6%9F%A5%E9%9B%86%20(2).png" alt=""></p><p>仍和上题情况一样：</p><ul><li>2 和 4 同种：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><msub><mi>s</mi><mn>2</mn></msub><mo>≡</mo><mi>d</mi><mi>i</mi><msub><mi>s</mi><mn>3</mn></msub><mo>+</mo><mi>d</mi><mi>i</mi><msub><mi>s</mi><mn>4</mn></msub><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dis_2 \equiv dis_3+dis_4 \pmod3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>。</li><li>2 吃 4：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><msub><mi>s</mi><mn>2</mn></msub><mo>≡</mo><mi>d</mi><mi>i</mi><msub><mi>s</mi><mn>3</mn></msub><mo>+</mo><mi>d</mi><mi>i</mi><msub><mi>s</mi><mn>4</mn></msub><mo>+</mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dis_2 \equiv dis_3+dis_4+1 \pmod3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.4444444444444444em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>。</li></ul><p>移一下项即可。代码见命名空间 2，详情见注释。</p><h3 id="代码-2"><a class="markdownIt-Anchor" href="#代码-2"></a> 代码</h3><pre class="highlight"><code class="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
<span class="hljs-keyword">namespace</span> _yz1<span class="hljs-comment">//扩展域并查集</span>
&#123;
	<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">50000</span>+<span class="hljs-number">10</span>,M=<span class="hljs-number">100000</span>+<span class="hljs-number">10</span>;
	<span class="hljs-type">int</span> n,m,dad[N*<span class="hljs-number">3</span>],ans=<span class="hljs-number">0</span>;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">start</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
	</span>&#123;
    	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
       		dad[i]=i;
   		<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>
	</span>&#123;   
    	<span class="hljs-keyword">while</span>(x!=dad[x])
        	x=dad[x]=dad[dad[x]];
    	<span class="hljs-keyword">return</span> x;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span>
	</span>&#123;
    	<span class="hljs-type">int</span> d1=<span class="hljs-built_in">find</span>(x),d2=<span class="hljs-built_in">find</span>(y);
    	dad[d1]=d2;
    	<span class="hljs-keyword">return</span>;
	&#125;	
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-type">int</span> t1,t2,t3;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);<span class="hljs-built_in">start</span>(n*<span class="hljs-number">3</span>);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
		&#123;
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;t1,&amp;t2,&amp;t3);
			<span class="hljs-keyword">if</span>(t2&gt;n || t3&gt;n) &#123;ans++;<span class="hljs-keyword">continue</span>;&#125;
			<span class="hljs-keyword">if</span>(t1==<span class="hljs-number">1</span>)
			&#123;
				<span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(t2)==<span class="hljs-built_in">find</span>(t3+n) || <span class="hljs-built_in">find</span>(t2)==<span class="hljs-built_in">find</span>(t3+n*<span class="hljs-number">2</span>)) &#123;ans++;<span class="hljs-keyword">continue</span>;&#125;
                <span class="hljs-comment">//如果 t2 和 t3 不是同类，fAKe 数加一。</span>
				<span class="hljs-built_in">union_</span>(t2,t3);
				<span class="hljs-built_in">union_</span>(t2+n,t3+n);
				<span class="hljs-built_in">union_</span>(t2+<span class="hljs-number">2</span>*n,t3+<span class="hljs-number">2</span>*n);
			&#125;
			<span class="hljs-keyword">else</span>
			&#123;
				<span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(t2)==<span class="hljs-built_in">find</span>(t3) || <span class="hljs-built_in">find</span>(t2)==<span class="hljs-built_in">find</span>(t3+n*<span class="hljs-number">2</span>)) &#123;ans++;<span class="hljs-keyword">continue</span>;&#125;
                <span class="hljs-comment">//如果 t2 和 t3 是同类，或 t3 反过来吃了 t2，fAKe 数加一。</span>
				<span class="hljs-built_in">union_</span>(t2,t3+n);
				<span class="hljs-built_in">union_</span>(t2+n,t3+n*<span class="hljs-number">2</span>);
				<span class="hljs-built_in">union_</span>(t2+n*<span class="hljs-number">2</span>,t3);
			&#125;
		&#125;
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,ans);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;
<span class="hljs-keyword">namespace</span> _yz2<span class="hljs-comment">//带权并查集</span>
&#123;
	<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">50000</span>+<span class="hljs-number">10</span>,M=<span class="hljs-number">100000</span>+<span class="hljs-number">10</span>;
	<span class="hljs-type">int</span> n,m,dad[N],dis[N],ans=<span class="hljs-number">0</span>;
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">moder</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<span class="hljs-keyword">return</span> (x%<span class="hljs-number">3</span>+<span class="hljs-number">3</span>)%<span class="hljs-number">3</span>;&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">start</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
	</span>&#123;
    	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
       		dad[i]=i;
   		<span class="hljs-keyword">return</span>;
	&#125;
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>
    </span>&#123;
        <span class="hljs-type">int</span> ret;
        <span class="hljs-keyword">if</span>(dad[x]==x)
            <span class="hljs-keyword">return</span> dad[x];
        ret=<span class="hljs-built_in">find</span>(dad[x]);
        dis[x]=<span class="hljs-built_in">moder</span>(dis[x]+dis[dad[x]]);
        <span class="hljs-keyword">return</span> dad[x]=ret;
    &#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-type">int</span> t1,t2,t3;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);<span class="hljs-built_in">start</span>(n);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)
		&#123;
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>,&amp;t1,&amp;t2,&amp;t3);
			<span class="hljs-keyword">if</span>(t2&gt;n || t3&gt;n || (t1==<span class="hljs-number">2</span>&amp;&amp;t2==t3)) &#123;ans++;<span class="hljs-keyword">continue</span>;&#125;
			<span class="hljs-keyword">if</span>(t1==<span class="hljs-number">1</span>)
			&#123;
				<span class="hljs-type">int</span> d1=<span class="hljs-built_in">find</span>(t2),d2=<span class="hljs-built_in">find</span>(t3);
				<span class="hljs-keyword">if</span>(d1==d2 &amp;&amp; <span class="hljs-built_in">moder</span>(dis[t2])!=<span class="hljs-built_in">moder</span>(dis[t3])) &#123;ans++;<span class="hljs-keyword">continue</span>;&#125;
                <span class="hljs-comment">//如果 d1 和 d2 已合并过，且两者不同类，fAKe 数加一。</span>
       			<span class="hljs-keyword">if</span>(d1!=d2) dis[d1]=<span class="hljs-built_in">moder</span>(dis[t3]-dis[t2]),dad[d1]=d2;
                <span class="hljs-comment">//没被合并，计算 dis 值。</span>
			&#125;
			<span class="hljs-keyword">else</span>
			&#123;
				<span class="hljs-type">int</span> d1=<span class="hljs-built_in">find</span>(t2),d2=<span class="hljs-built_in">find</span>(t3);
				<span class="hljs-keyword">if</span>(d1==d2 &amp;&amp; <span class="hljs-built_in">moder</span>(dis[t2])!=<span class="hljs-built_in">moder</span>(dis[t3]+<span class="hljs-number">1</span>)) &#123;ans++;<span class="hljs-keyword">continue</span>;&#125;
                <span class="hljs-comment">//如果 d1 和 d2 已合并过，且两者吃的关系不对，fAKe 数加一。</span>
        		<span class="hljs-keyword">if</span>(d1!=d2) dis[d1]=<span class="hljs-built_in">moder</span>(<span class="hljs-built_in">moder</span>(dis[t3]+<span class="hljs-number">1</span>)-<span class="hljs-built_in">moder</span>(dis[t2])),dad[d1]=d2;
                <span class="hljs-comment">//没被合并，计算 dis 值。</span>
			&#125;
		&#125;
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,ans);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>&#123;
    <span class="hljs-comment">//freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);</span>
	<span class="hljs-comment">//freopen(&quot;out.txt&quot;,&quot;w&quot;,stdout);</span>
	_yzCE::<span class="hljs-built_in">yzmain</span>();
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;

</code></pre></details><h2 id="p1197-jsoi2008星球大战"><a class="markdownIt-Anchor" href="#p1197-jsoi2008星球大战"></a> P1197 [JSOI2008]星球大战</h2><h3 id="题意-2"><a class="markdownIt-Anchor" href="#题意-2"></a> 题意</h3><p>无向图，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">4\times10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span> 个点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">2\times10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span> 条边，顺次删去点，顺次统计连通块个数。</p><details><summary>点击查看题解</summary><h3 id="题解-3"><a class="markdownIt-Anchor" href="#题解-3"></a> 题解</h3><p>既然按顺次不好解决，我们可以使用逆向思维，使用离线算法。</p><p>我们用邻接表和并查集来维护。先把图建好，并查集合并时把被摧毁的星球屏蔽掉，得到连通块数 total。这是要输出的最后一个答案。</p><p>再逆向一个个恢复星球。每回复一个时，total 首先要加一（星球本身是连通块）。按照建的图，对这个点所相连的点尝试并查集合并。若合并成功（两者不属于同一集合且另一个星球是没被摧毁的），连通块个数减一。</p><p>存下答案，再逆向输出答案即可。</p><h3 id="代码-3"><a class="markdownIt-Anchor" href="#代码-3"></a> 代码</h3><pre class="highlight"><code class="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
<span class="hljs-keyword">namespace</span> _yz
&#123;
	<span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">400000</span>+<span class="hljs-number">10</span>;
	<span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;<span class="hljs-type">int</span> nxt,to;&#125;e[N];
	<span class="hljs-type">int</span> head[N],cnt=<span class="hljs-number">0</span>,n,m,k,dead[N],dstar[N],ans[N],dad[N],total=<span class="hljs-number">0</span>;
	<span class="hljs-type">int</span> ta[N],tb[N];
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span>&#123;e[++cnt]=(edge)&#123;head[x],y&#125;;head[x]=cnt;&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">start</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
	</span>&#123;
    	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)
       		dad[i]=i;
   		<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>
	</span>&#123;   
    	<span class="hljs-keyword">while</span>(x!=dad[x])
        	x=dad[x]=dad[dad[x]];
    	<span class="hljs-keyword">return</span> x;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">union_</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span>
	</span>&#123;
    	<span class="hljs-type">int</span> d1=<span class="hljs-built_in">find</span>(x),d2=<span class="hljs-built_in">find</span>(y);
    	dad[d1]=d2;
    	<span class="hljs-keyword">return</span>;
	&#125;	
	<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getans</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-type">int</span> ret=<span class="hljs-number">0</span>;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=n<span class="hljs-number">-1</span>;i++)
			<span class="hljs-keyword">if</span>(dad[i]==i &amp;&amp; dead[i]!=<span class="hljs-number">1</span>) ret++;
		<span class="hljs-keyword">return</span> ret;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-type">int</span> ta,tb;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);<span class="hljs-built_in">start</span>(n);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++) 
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;ta,&amp;tb),<span class="hljs-built_in">add</span>(ta,tb),<span class="hljs-built_in">add</span>(tb,ta);
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;k);
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=k;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,dstar+i),dead[dstar[i]]=<span class="hljs-number">1</span>;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=n<span class="hljs-number">-1</span>;i++)
		&#123;
			<span class="hljs-keyword">if</span>(dead[i]) <span class="hljs-keyword">continue</span>;
			<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=head[i];j;j=e[j].nxt)
				<span class="hljs-keyword">if</span>(!dead[e[j].to])
					<span class="hljs-built_in">union_</span>(e[j].to,i);
		&#125;
		total=ans[k]=<span class="hljs-built_in">getans</span>();
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=k;i&gt;=<span class="hljs-number">1</span>;i--)
		&#123;
			total++;
			<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=head[dstar[i]];j;j=e[j].nxt)
			&#123;
				<span class="hljs-type">int</span> to=e[j].to;
				<span class="hljs-keyword">if</span>(<span class="hljs-built_in">find</span>(dstar[i])!=<span class="hljs-built_in">find</span>(to) &amp;&amp; dead[to]!=<span class="hljs-number">1</span>)
					<span class="hljs-built_in">union_</span>(dstar[i],to),total--;
			&#125;
			ans[i<span class="hljs-number">-1</span>]=total;
			dead[dstar[i]]=<span class="hljs-number">0</span>;
		&#125;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;=k;i++)
			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,ans[i]);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>&#123;
	<span class="hljs-comment">//freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);</span>
	<span class="hljs-comment">//freopen(&quot;out.txt&quot;,&quot;w&quot;,stdout);</span>
	_yz::<span class="hljs-built_in">yzmain</span>();
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;

</code></pre></details><br><hr><br><blockquote><br>本文作者：Yurchiu<br><br>本文链接：https://yz-hs.github.io/fb7ca72a2695/<br><br>版权声明：本博客中所有原创文章除特别声明外，均允许规范转载，转载请注明出处。所有非原创文章，按照原作者要求转载。<br><br></blockquote><br><div class="end-post-meta"><span><a href="/tags/OI"><i class="fa fa-tag"></i> OI</a></span> <span><a href="/tags/二分"><i class="fa fa-tag"></i> 二分</a></span> <span><a href="/tags/图论"><i class="fa fa-tag"></i> 图论</a></span> <span><a href="/tags/并查集"><i class="fa fa-tag"></i> 并查集</a></span> <span><a href="/tags/离线算法"><i class="fa fa-tag"></i> 离线算法</a></span> <span><a href="/tags/二分答案"><i class="fa fa-tag"></i> 二分答案</a></span></div><div class="end-post-meta"><span><i class="fa fa-refresh"></i> 最后更新：2023-08-21, 23:18:21</span></div></div><div class="prevnext"><a class="prev" href="/f8c2e460e894/">上一页</a> <a class="next" href="/dbd6ef846d33/">下一页</a></div><div class="comments"><div class="giscus"></div><script>function my_giscus_load(){var t=document.createElement("script");t.setAttribute("src","https://giscus.app/client.js"),t.setAttribute("data-repo","yz-hs/no-star"),t.setAttribute("data-repo-id","R_kgDOKHnuhg"),t.setAttribute("data-category","General"),t.setAttribute("data-category-id","DIC_kwDOKHnuhs4CYog9"),t.setAttribute("data-mapping","pathname"),t.setAttribute("data-strict","0"),t.setAttribute("data-reactions-enabled","1"),t.setAttribute("data-emit-metadata","0"),t.setAttribute("data-input-position","top"),t.setAttribute("data-theme","light"),4==readData("color")&&t.setAttribute("data-theme","dark"),t.setAttribute("data-lang","zh-CN"),t.setAttribute("data-loading","lazy"),t.setAttribute("crossorigin","anonymous"),t.setAttribute("async","true"),document.head.appendChild(t)}my_giscus_load()</script></div><div class="avatar-container" style="padding:50px"><img src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-avatar.jpg" class="avatar revolve" style="height:12%;width:12%"><div style="text-align:center;margin-top:3%">By Yurchiu.</div></div></div><div class="vertical toolbar"><div class="tab-page"><div class="tabTitle tb-tabTitle"><ul><li class="current"><i class="fa fa-random"></i></li><li><i class="fa fa-refresh"></i></li><li><i class="fa fa-circle-o-notch"></i></li></ul></div><div class="tabContent tb-tabContent"><div><div class="title">随机文章<span class="sidetitle">回味旧文</span></div><div class="item no-lrpadding"><a class="post-link" href="/d24d99489782/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">2020 新年贺词</div></div></a><a class="post-link" href="/3513c6ef3e31/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">2021，初中毕业</div></div></a><a class="post-link" href="/3f5d366e12dd/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">一个 4 人囚徒困境的必胜策略</div></div></a><a class="post-link" href="/501647d25831/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">AFO 有感</div></div></a><a class="post-link" href="/ed885af1fef5/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">ASCII 艺术</div></div></a><a class="post-link" href="/2ab979d324b5/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">BSGS 与 exBSGS</div></div></a><a class="post-link" href="/1ed002c31ce3/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">CSP-J1 游记</div></div></a></div></div><div class="hide"><div class="title">最近更新<span class="sidetitle">旧文更新</span></div><div class="item no-lrpadding"><a class="post-link" href="/1f53cba6a83c/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报 10》</div></div></a><a class="post-link" href="/39e4c172e542/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">Cutie 使用文档</div></div></a><a class="post-link" href="/32cc033936e2/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">[Theme] Readme</div></div></a><a class="post-link" href="/d3dec5d93e6e/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">欢迎</div></div></a><a class="post-link" href="/5f04cc136ab4/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报 6》</div></div></a><a class="post-link" href="/7a042de58116/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报 2》</div></div></a><a class="post-link" href="/177a0b676a5c/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报 3》</div></div></a></div></div><div class="hide"><div class="title">其他物件<a data-bs-toggle="tooltip" href="javascript: document.body.contentEditable='true';
    document.designMode='on';void(0);" title="彩蛋：点击我，可以编辑本页面！" target="_self" class="sidetitle">杂物收纳</a></div><div style="height:10px"></div><div class="item"><tag style="display:inline-block">Hitokoto</tag><br><br><div id="hitokoto">Yurchiu 说，除了她以外的人都很强！嘤嘤嘤~~</div><script>fetch("https://v1.hitokoto.cn").then(function(t){return t.json()}).then(function(t){$("#hitokoto").html(t.hitokoto+"<br><br><div style='text-align: right;'>——"+t.from+"</div>")}).catch(function(t){console.error(t)})</script></div><div class="item"><div id="timeprogress"></div><script>var myDate=new Date,hours=myDate.getHours(),minutes=myDate.getMinutes(),pro=(minutes=60*hours+minutes)/14.4,innerhtml="        <div class='progress' style='height: 20px'>          <div data-bs-toggle='tooltip'               class='progress-bar'               title='时间已过去了 "+pro.toFixed(2)+"%'               style='width: "+pro+"%;               background: #4caf50; color: #fff;'>"+pro.toFixed(0)+"%          </div>        </div>";document.getElementById("timeprogress").innerHTML=innerhtml</script></div></div></div></div><div class="item"><div class="title">博客信息</div><div class="list-group"><div class="list-group-item"><div><i class="fa fa-file-text-o fa-fw"></i> 文章数目</div><div class="badge">158</div></div><div class="list-group-item"><div><i class="fa fa-refresh fa-fw"></i> 最近更新</div><div class="badge">08-21</div></div><div class="list-group-item"><div><i class="fa fa-font fa-fw"></i> 本站字数</div><div class="badge">345.4k</div></div></div></div><div class="post-toc"><div class="title">文章目录</div><div class="post-toc-inner"></div></div><script>tocbot.init({tocSelector:".post-toc-inner",contentSelector:".post-text",headingSelector:"h1, h2, h3, h4, h5, h6",hasInnerContainers:!0})</script><script>$(function(){var i=$(".tb-tabTitle>ul>li"),n=$(".tb-tabContent>div");i.click(function(){var t=$(this);setTimeout(function(){t.addClass("current").siblings().removeClass("current");var i=t.index();n.eq(i).show().siblings().hide()})})})</script></div></div><div class="footer"><p class="text-left">©2019-2023 <a target="_blank" rel="noopener" href="https://github.com/yz-hs">Yurchiu</a>. All rights reserved.</p><p class="text-right">Theme <a target="_blank" rel="noopener" href="https://github.com/yz-hs/cutie">Cutie</a>, by Yurchiu.</p></div><div class="natsuki-container" style="width:120px" data-bs-toggle="tooltip" title="Don't touch me! qwq"><img id="natsuki2" width="100%" height="100%" src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/natsuki2.png"> <img id="natsuki1" width="100%" height="100%" src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/natsuki1.png"></div><script type="text/javascript">$("#natsuki1").click(function(){$("#natsuki1").hide(),$("#natsuki2").show(),$("#natsuki2").css("animation","natsuki 0.55s cubic-bezier(0, 0, 0, 1)")}),$("#natsuki2").each(function(){$(this)[0].addEventListener("animationend",function(){$("#natsuki2").hide(),$("#natsuki1").show(),$(this).css("animation","")})})</script><script>readData("special")||$("html").addClass("none")</script><script>readData("color")||$("html").addClass("color-white"),4==readData("color")&&($("body").css("opacity","0.85"),$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/night-bgp.jpg)")),$("img").attr("onerror","this.src='https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/error.jpg';this.onerror=null"),initial()</script></div><meting-js class="meting-js appear" fixed="ture" server="netease" type="playlist" id="8524070964"></meting-js><script>consolePrint(),HideIt()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/custom/custom.css"><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/custom/custom.js"></script></body></html>