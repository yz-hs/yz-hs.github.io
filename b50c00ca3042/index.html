<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="msvalidate.01" content="A7B4DB5A7BF5E5C6E52E34BB024D6319"><meta name="description" content="本站为 Yurchiu 用来记录 OI、笔记、感想的 Blog，欢迎来到本博客！希望我们能相互交流，共同进步～"><meta http-equiv="content-language" content="zh-cn"><title>P1850 [NOIP2016 提高组] 换教室 | Yurchiu's Blog</title><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.4.17/sweetalert2.all.min.js"></script><script src="https://cdn.staticfile.org/sketch.js/1.0/sketch.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/chaffle.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/main.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/search.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/initial.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.6/katex.min.css"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/vs2015.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/css/style.css"><link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Yurchiu's Blog" type="application/atom+xml"></head><body style="background-image:url(https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-bgp.png)"><div id="YurLoading" class="YurLoading"><div class="inner"><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div></div></div><div class="topbar"><a onclick="topbarToggle()" class="topbar-menu" style="cursor:pointer"><i class="fa fa-bars"></i> </a><a href="/" class="topbar-title"><i class="fa fa-home"></i> Yurchiu's Blog </a><a target="_blank" rel="noopener" href="https://github.com/yz-hs" class="topbar-title"><i class="fa fa-github"></i></a></div><div id="article-container"><div class="sidebar"><div class="avatar-container"><img src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-avatar.jpg" class="avatar revolve"></div><div class="sidebar-author">Yurchiu<br><span class="mini-text">An AFO whker.</span></div><div class="sidebar-list-container"><div style="height:10px"></div><a class="list-group-item" href="/"><div><i class="fa fa-home fa-fw"></i>&nbsp; 首页</div><div class="badge"></div></a><a class="list-group-item" href="/archives/"><div><i class="fa fa-tasks fa-fw"></i>&nbsp; 归档</div><div class="badge">158</div></a><a class="list-group-item" href="/tags/"><div><i class="fa fa-tags fa-fw"></i>&nbsp; 标签</div><div class="badge">81</div></a><a class="list-group-item" href="/categories/"><div><i class="fa fa-th-large fa-fw"></i>&nbsp; 分类</div><div class="badge">24</div></a><a class="list-group-item" href="/somepage/mood/"><div><i class="fa fa-photo fa-fw"></i>&nbsp; 说说</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/about/"><div><i class="fa fa-user-o fa-fw"></i>&nbsp; 关于</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/chat/"><div><i class="fa fa-commenting-o fa-fw"></i>&nbsp; 留言</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/link/"><div><i class="fa fa-link fa-fw"></i>&nbsp; 链接</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/settings/"><div><i class="fa fa-cog fa-fw"></i>&nbsp; 设置</div><div class="badge"></div></a><div style="height:200px"></div></div><div class="sidebar-footer"><div class="item" id="back2Top" data-bs-toggle="tooltip" title="顶部"><i class="fa fa-arrow-circle-up"></i></div><div class="item" id="back2Down" data-bs-toggle="tooltip" title="底部"><i class="fa fa-arrow-circle-down"></i></div><div class="item" data-bs-toggle="tooltip" title="RSS"><a href="/atom.xml"><i class="fa fa-feed"></i></a></div><div class="item" data-bs-toggle="tooltip" title="搜索"><a href="/somepage/search/"><i class="fa fa-search"></i></a></div></div></div><div class="article"><div class="vertical fake-sidebar"></div><div class="vertical post"><div class="header"><h1 class="title">P1850 [NOIP2016 提高组] 换教室</h1><div class="meta"><span><i class="fa fa-user-o"></i> xzy,fsl,mzf,Yurchiu </span><span><i class="fa fa-clock-o"></i> 2021-08-27, 20:57:50</span> <span><i class="fa fa-font"></i> 3.1k</span> <span class="hideBars" onclick="hideBars()"><i class="fa fa-eye-slash"></i> 隐藏左右两栏 </span><span class="showBars" onclick="showBars()"><i class="fa fa-eye"></i> 展示左右两栏</span></div></div><div class="breadcrumb"><div class="url"><a href="/"><i class="fa fa-home"></i> 首页</a> / P1850 [NOIP2016 提高组] 换教室</div><div class="share">分享到 <a target="_blank" rel="noopener" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://yz-hs.github.io/b50c00ca3042/&title=P1850 [NOIP2016 提高组] 换教室&site=https://yz-hs.github.io"><i class="fa fa-qq"></i></a></div></div><div class="post-text"><h1 id="题意"><a class="markdownIt-Anchor" href="#题意"></a> 题意</h1><ul><li><p>有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord mathnormal">n</span></span></span></span> 节课程安排在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> 个时间段上。在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \leq i \leq n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78041em;vertical-align:-.13597em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.79549em;vertical-align:-.13597em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span>）个时间段上，两节内容相同的课程同时在不同的地点进行。</p></li><li><p>Yurchiu 预先被安排在教室 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 上课，而另一节课程在教室 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 进行。</p></li><li><p>Yurchiu 需要按时间段的顺序依次完成所有的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> 节课程。如果想更换第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span> 节课程的教室，则需要提出申请。若申请通过，Yurchiu 就可以在第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span> 个时间段去教室 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 上课，否则仍然在教室 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>​​ 上课。</p></li></ul><span id="more"></span><ul><li><p>申请被通过的概率是一个已知的实数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>​​，并且对于不同课程的申请，通过概率互相独立。</p></li><li><p>大学有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span> 个教室，有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">e</span></span></span></span> 条道路。每条道路连接两间教室且双向通行。道路有权值，当第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \leq i \leq n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78041em;vertical-align:-.13597em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.79549em;vertical-align:-.13597em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>​）节课结束后，从此教室出发，选择一条权值最小的路径前往下一节课的教室。</p></li></ul><p>Yurchiu 想知道申请哪几门课程可以使她因在教室间移动而产生的权值和的期望值最小。只需求出这个最小值。</p><details><summary>点击查看题解</summary><h1 id="题解"><a class="markdownIt-Anchor" href="#题解"></a> 题解</h1><p>本题解来自 3 位大佬的课件。</p><h2 id="0x01-24-pts"><a class="markdownIt-Anchor" href="#0x01-24-pts"></a> 0x01 24 pts</h2><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">m=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>​​ 就意味着无法申请，这就和期望无关了。于是，只要求出各个点之间的最短路，按时间加起来就可以了。</p><p>使用 floyd 算法求最短路计算任意两个教室之间的最短路。</p><p>注意：</p><ol><li>for 循环的范围是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>∼</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">1\sim v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span>，而不是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>∼</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1\sim n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span>。</li><li>不要忘记 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i=j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span></span></span></span>​ 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><msub><mi>s</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">dis_{i,j}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>​ （<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn></mrow><annotation encoding="application/x-tex">12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span></span></span></span>​​​ 分，我不知道为什么会得分）。非常重要，对于其他题目也适用。</li><li>floyd 算法使用邻接矩阵存储图，注意重边的处理。</li></ol><p>时间复杂度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>v</mi><mn>3</mn></msup><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(v^3+n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>​。</p><pre class="highlight"><code class="cpp"><span class="hljs-type">void</span> _24pts()
&#123;
	<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">2</span>;i&lt;=n;i++)
	&#123;
		ans+=dis[c[i<span class="hljs-number">-1</span>]][c[i]];
		pre[i]=ans;
	&#125;
	<span class="hljs-keyword">return</span>;
&#125;
</code></pre><h2 id="0x02-52-pts"><a class="markdownIt-Anchor" href="#0x02-52-pts"></a> 0x02 52 pts</h2><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 时仅能申请一个。图是不变的，仍然跑 floyd。</p><p>分为两种情况：</p><ol><li>不申请。相当于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">m=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>​，与 24 分算法结合。</li><li>申请，又分为两种情况：<ol><li>申请成功。需要更改从上一个教室到更换后教室的距离以及更换后教室到下一个教室的距离。按时间段累加距离，并乘 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>。</li><li>申请失败。距离不变，乘 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-k_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>​。</li></ol></li></ol><p>注：</p><ol><li>可以在累加过程中乘概率。</li><li>如果在累加过程中大于已知的 ans，就可以 break。</li></ol><p>如此，floyd 后，先算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">m=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>​ 的情况，后枚举要换的教室，每一次枚举都累加一次。</p><p>时间复杂度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>v</mi><mn>3</mn></msup><mo>+</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(v^3+n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>​​​。</p><pre class="highlight"><code class="cpp"><span class="hljs-type">void</span> _52pts()
&#123;
	<span class="hljs-built_in">memset</span>(a52,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(a52));
	<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">2</span>;i&lt;=n;i++)
		<span class="hljs-keyword">for</span>(ll j=<span class="hljs-number">1</span>;j&lt;=n;j++)
		&#123;
			a52[i][j]+=a52[i<span class="hljs-number">-1</span>][j];
			<span class="hljs-keyword">if</span>(i==j)
			&#123;
				a52[i][j]+=(dis[c[i<span class="hljs-number">-1</span>]][d[i]])*k[i];
				a52[i][j]+=(dis[c[i<span class="hljs-number">-1</span>]][c[i]])*(<span class="hljs-number">1</span>-k[i]);
			&#125;
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>==j)
			&#123;
				a52[i][j]+=(dis[d[i<span class="hljs-number">-1</span>]][c[i]])*k[i<span class="hljs-number">-1</span>];
				a52[i][j]+=(dis[c[i<span class="hljs-number">-1</span>]][c[i]])*(<span class="hljs-number">1</span>-k[i<span class="hljs-number">-1</span>]);
			&#125;
			<span class="hljs-keyword">else</span> a52[i][j]+=dis[c[i<span class="hljs-number">-1</span>]][c[i]];
		&#125;
	<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++)
		ans=<span class="hljs-built_in">min</span>(ans,a52[n][i]);
&#125;
</code></pre><p>本程序有优化的余地。</p><ol><li>a52 数组可以滚动优化，滚掉 1 维（很显然是不是）。</li><li>进一步优化：我们发现，不需要每次从 1 到 n 都累加一遍。只需要在特殊的地方加一下，然后其他的地方前缀和优化即可。</li></ol><p>时间复杂度降为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>v</mi><mn>3</mn></msup><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(v^3+n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>​​。</p><pre class="highlight"><code class="cpp"><span class="hljs-function">ll <span class="hljs-title">query</span><span class="hljs-params">(ll l,ll r)</span> </span>&#123;<span class="hljs-keyword">return</span> pre[r]-pre[l<span class="hljs-number">-1</span>];&#125;
<span class="hljs-type">void</span> _52pts()
&#123;
	<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++)
	&#123;
		a52=<span class="hljs-number">0</span>;
			
		<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">1</span>) a52+=(dis[c[i<span class="hljs-number">-1</span>]][d[i]])*(k[i]);
		<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">1</span>) a52+=(dis[c[i<span class="hljs-number">-1</span>]][c[i]])*(<span class="hljs-number">1</span>-k[i]);
		<span class="hljs-keyword">if</span>(i+<span class="hljs-number">1</span>&lt;=n) a52+=(dis[d[i]][c[i+<span class="hljs-number">1</span>]])*(k[i]);
		<span class="hljs-keyword">if</span>(i+<span class="hljs-number">1</span>&lt;=n) a52+=(dis[c[i]][c[i+<span class="hljs-number">1</span>]])*(<span class="hljs-number">1</span>-k[i]);
			
		<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">2</span>) a52+=<span class="hljs-built_in">query</span>(<span class="hljs-number">2</span>,i<span class="hljs-number">-1</span>);
		<span class="hljs-keyword">if</span>(i+<span class="hljs-number">2</span>&lt;=n) a52+=<span class="hljs-built_in">query</span>(i+<span class="hljs-number">2</span>,n);
			
		ans=<span class="hljs-built_in">min</span>(ans,a52);
	&#125;
&#125;
</code></pre><h2 id="0x03-76-pts"><a class="markdownIt-Anchor" href="#0x03-76-pts"></a> 0x03 76 pts</h2><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span></span></span></span> 时，分为 3 种情况：</p><ol><li>不申请。</li><li>仅申请一个。</li><li>申请两个。</li></ol><p>关于 1 和 2，其实就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，结合之前的程序即可；关于 3，我们需要枚举申请的是哪两个。</p><p>两层循环找组合，复杂度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>​。每种组合都累加一下。有 4 种情况：</p><ol><li>都申请成功。</li><li>第一个申请成功，第二个没申请成功。</li><li>第一个没申请成功，第二个申请成功。</li><li>都没申请成功。</li></ol><p>类似地，按照 52 分解的处理方法，76 分拿到了。</p><p>时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>v</mi><mn>3</mn></msup><mo>+</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(v^3+n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>​​。</p><pre class="highlight"><code class="cpp"><span class="hljs-type">void</span> _76pts()
&#123;
	<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n<span class="hljs-number">-1</span>;i++)
	&#123;
		<span class="hljs-keyword">for</span>(ll j=i+<span class="hljs-number">1</span>;j&lt;=n;j++)
		&#123;
			a76=<span class="hljs-number">0</span>;
				
			<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">1</span>) a76+=(dis[c[i<span class="hljs-number">-1</span>]][d[i]])*(k[i]);
			<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">1</span>) a76+=(dis[c[i<span class="hljs-number">-1</span>]][c[i]])*(<span class="hljs-number">1</span>-k[i]);
			<span class="hljs-keyword">if</span>(j+<span class="hljs-number">1</span>&lt;=n) a76+=(dis[d[j]][c[j+<span class="hljs-number">1</span>]])*(k[j]);
			<span class="hljs-keyword">if</span>(j+<span class="hljs-number">1</span>&lt;=n) a76+=(dis[c[j]][c[j+<span class="hljs-number">1</span>]])*(<span class="hljs-number">1</span>-k[j]);
				
			<span class="hljs-keyword">if</span>(i+<span class="hljs-number">1</span>==j)
			&#123;
				a76+=(dis[d[i]][d[j]])*(k[i]*k[j]);
				a76+=(dis[d[i]][c[j]])*(k[i]*(<span class="hljs-number">1</span>-k[j]));
				a76+=(dis[c[i]][d[j]])*((<span class="hljs-number">1</span>-k[i])*k[j]);
				a76+=(dis[c[i]][c[j]])*((<span class="hljs-number">1</span>-k[i])*(<span class="hljs-number">1</span>-k[j]));
			&#125;
			<span class="hljs-keyword">else</span>
			&#123;
				a76+=(dis[d[i]][c[i+<span class="hljs-number">1</span>]])*(k[i]);
				a76+=(dis[c[i]][c[i+<span class="hljs-number">1</span>]])*(<span class="hljs-number">1</span>-k[i]);
				a76+=(dis[c[j<span class="hljs-number">-1</span>]][d[j]])*(k[j]);
				a76+=(dis[c[j<span class="hljs-number">-1</span>]][c[j]])*(<span class="hljs-number">1</span>-k[j]);
			&#125;
				
			<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">2</span>) a76+=<span class="hljs-built_in">query</span>(<span class="hljs-number">2</span>,i<span class="hljs-number">-1</span>);
			<span class="hljs-keyword">if</span>(j+<span class="hljs-number">2</span>&lt;=n) a76+=<span class="hljs-built_in">query</span>(j+<span class="hljs-number">2</span>,n);
			<span class="hljs-keyword">if</span>(i+<span class="hljs-number">2</span>&lt;=j<span class="hljs-number">-1</span>) a76+=<span class="hljs-built_in">query</span>(i+<span class="hljs-number">2</span>,j<span class="hljs-number">-1</span>);
				
			ans=<span class="hljs-built_in">min</span>(a76,ans);
		&#125;
	&#125;
&#125;
</code></pre><h2 id="0x04-100-pts"><a class="markdownIt-Anchor" href="#0x04-100-pts"></a> 0x04 100 pts</h2><p>考虑使用动态规划来解。</p><p>显然，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> 是 dp 过程中不可忽略的状态。接下来对此探究一下：</p><p>在之前的骗分过程中，我们很容易发现申请不同的个数是互不影响的，那我们仅考虑申请已知个数时如何进行选择。这就与申请个数的分配有关了。</p><p>初始的想法是用区间 dp 的思想去设计状态：设 <code>f[i][j][k]</code> 表示时间段 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span></span></span></span> 分配了 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span> 个申请的最优解。发现这样需要 4 层循环（枚举 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">mid</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span></span></span></span>），显然，时间复杂度过高。</p><p>这样，我们可以舍弃左端点。</p><p>设 <code>f[i][j]</code> 表示时间段 <code>[1,i]</code> 分配了 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span></span></span></span> 个申请的最优解。这样枚举 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span></span></span></span>，看 <code>f[i][j]</code> 可以由哪些状态转移来。时间复杂度可以接受。</p><p>我们要做到从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.74285em;vertical-align:-.08333em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>​​ 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>​​​，在推进过程中一步步取最优。这就需要我们知道新增时间段是否申请：</p><ol><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span> 不申请，那么就看 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.74285em;vertical-align:-.08333em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 申不申请。</li><li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span> 申请，同样要看 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.74285em;vertical-align:-.08333em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 申不申请。</li></ol><p>无疑，我们需要知道时间段 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.74285em;vertical-align:-.08333em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>​​​ 的教室有没有换。即下一个状态 <code>f[i][j]</code> 的转移和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.74285em;vertical-align:-.08333em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>​​ 是否申请成功有关。于是，我们再加一维 0/1，表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>​​​ 是否申请成功。</p><p>看来，我们既需要知道 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>​​ 是否申请，也要知道 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.74285em;vertical-align:-.08333em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>​​ 是否申请。于是，我们可以设 <code>add[0/1][0/1]</code> 表示当我们考虑到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>​ 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.74285em;vertical-align:-.08333em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>​​ 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>​​ 是否申请而造成的新的代价。</p><p>状态转移方程很冗杂，但很好推。可以结合代码进行理解。</p><pre class="highlight"><code class="cpp"><span class="hljs-type">void</span> _100pts()
&#123;
	<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">0</span>;i&lt;=n;i++)
		<span class="hljs-keyword">for</span>(ll j=<span class="hljs-number">0</span>;j&lt;=m;j++)
			f[i][j][<span class="hljs-number">0</span>]=f[i][j][<span class="hljs-number">1</span>]=inf;
	f[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=f[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;<span class="hljs-comment">//刚开始的教室，无论换还是不换，都相当于不用跑路 </span>
	<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">2</span>;i&lt;=n;i++)
	&#123;
		add[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=dis[c[i<span class="hljs-number">-1</span>]][c[i]];
		add[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]=dis[c[i<span class="hljs-number">-1</span>]][c[i]]*(<span class="hljs-number">1</span>-k[i])+
				  dis[c[i<span class="hljs-number">-1</span>]][d[i]]*(k[i]);
		add[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=dis[c[i<span class="hljs-number">-1</span>]][c[i]]*(<span class="hljs-number">1</span>-k[i<span class="hljs-number">-1</span>])+
				  dis[d[i<span class="hljs-number">-1</span>]][c[i]]*(k[i<span class="hljs-number">-1</span>]);
		add[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]=dis[c[i<span class="hljs-number">-1</span>]][c[i]]*((<span class="hljs-number">1</span>-k[i<span class="hljs-number">-1</span>])*(<span class="hljs-number">1</span>-k[i]))+
				  dis[c[i<span class="hljs-number">-1</span>]][d[i]]*((<span class="hljs-number">1</span>-k[i<span class="hljs-number">-1</span>])*k[i])+
				  dis[d[i<span class="hljs-number">-1</span>]][c[i]]*(k[i<span class="hljs-number">-1</span>]*(<span class="hljs-number">1</span>-k[i]))+
				  dis[d[i<span class="hljs-number">-1</span>]][d[i]]*(k[i<span class="hljs-number">-1</span>]*k[i]);
			
		f[i][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=f[i<span class="hljs-number">-1</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]+add[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>];
		<span class="hljs-keyword">for</span>(ll j=<span class="hljs-number">1</span>;j&lt;=<span class="hljs-built_in">min</span>(m,i);j++)
		&#123;
			f[i][j][<span class="hljs-number">0</span>]=<span class="hljs-built_in">min</span>(f[i][j][<span class="hljs-number">0</span>],
					   <span class="hljs-built_in">min</span>(f[i<span class="hljs-number">-1</span>][j][<span class="hljs-number">0</span>]+add[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>],
						   f[i<span class="hljs-number">-1</span>][j][<span class="hljs-number">1</span>]+add[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]));
							   
			f[i][j][<span class="hljs-number">1</span>]=<span class="hljs-built_in">min</span>(f[i][j][<span class="hljs-number">1</span>],
					   <span class="hljs-built_in">min</span>(f[i<span class="hljs-number">-1</span>][j<span class="hljs-number">-1</span>][<span class="hljs-number">0</span>]+add[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>],
						   f[i<span class="hljs-number">-1</span>][j<span class="hljs-number">-1</span>][<span class="hljs-number">1</span>]+add[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]));
		&#125;
	&#125;
	<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">0</span>;i&lt;=m;i++)
	&#123;
		ans=<span class="hljs-built_in">min</span>(ans,f[n][i][<span class="hljs-number">0</span>]);
		ans=<span class="hljs-built_in">min</span>(ans,f[n][i][<span class="hljs-number">1</span>]);
	&#125;
&#125;
</code></pre><h1 id="代码"><a class="markdownIt-Anchor" href="#代码"></a> 代码</h1><p>这里是所有部分分解和正解的代码。如果单独跑 <code>_100pts()</code> 需要把 ans 置为 inf，而且更快。</p><pre class="highlight"><code class="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
<span class="hljs-keyword">namespace</span> _yz
&#123;
	<span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;
	<span class="hljs-type">const</span> ll V=<span class="hljs-number">300</span>+<span class="hljs-number">10</span>,N=<span class="hljs-number">2000</span>+<span class="hljs-number">10</span>,inf=<span class="hljs-number">2147483647</span>;
	ll dis[V][V],n,m,v,e,c[N],d[N],pre[N];
	<span class="hljs-type">double</span> k[N],ans=<span class="hljs-number">0</span>,a52,a76,a100,add[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>];
	<span class="hljs-type">double</span> f[N][N][<span class="hljs-number">2</span>];
	<span class="hljs-type">void</span> _24pts()
	&#123;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">2</span>;i&lt;=n;i++)
		&#123;
			ans+=dis[c[i<span class="hljs-number">-1</span>]][c[i]];
			pre[i]=ans;
		&#125;
		<span class="hljs-keyword">return</span>;
	&#125;
	<span class="hljs-function">ll <span class="hljs-title">query</span><span class="hljs-params">(ll l,ll r)</span> </span>&#123;<span class="hljs-keyword">return</span> pre[r]-pre[l<span class="hljs-number">-1</span>];&#125;
	<span class="hljs-type">void</span> _52pts()
	&#123;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++)
		&#123;
			a52=<span class="hljs-number">0</span>;
			
			<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">1</span>) a52+=(dis[c[i<span class="hljs-number">-1</span>]][d[i]])*(k[i]);
			<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">1</span>) a52+=(dis[c[i<span class="hljs-number">-1</span>]][c[i]])*(<span class="hljs-number">1</span>-k[i]);
			<span class="hljs-keyword">if</span>(i+<span class="hljs-number">1</span>&lt;=n) a52+=(dis[d[i]][c[i+<span class="hljs-number">1</span>]])*(k[i]);
			<span class="hljs-keyword">if</span>(i+<span class="hljs-number">1</span>&lt;=n) a52+=(dis[c[i]][c[i+<span class="hljs-number">1</span>]])*(<span class="hljs-number">1</span>-k[i]);
			
			<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">2</span>) a52+=<span class="hljs-built_in">query</span>(<span class="hljs-number">2</span>,i<span class="hljs-number">-1</span>);
			<span class="hljs-keyword">if</span>(i+<span class="hljs-number">2</span>&lt;=n) a52+=<span class="hljs-built_in">query</span>(i+<span class="hljs-number">2</span>,n);
			
			ans=<span class="hljs-built_in">min</span>(ans,a52);
		&#125;
	&#125;
	<span class="hljs-type">void</span> _76pts()
	&#123;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n<span class="hljs-number">-1</span>;i++)
		&#123;
			<span class="hljs-keyword">for</span>(ll j=i+<span class="hljs-number">1</span>;j&lt;=n;j++)
			&#123;
				a76=<span class="hljs-number">0</span>;
				
				<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">1</span>) a76+=(dis[c[i<span class="hljs-number">-1</span>]][d[i]])*(k[i]);
				<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">1</span>) a76+=(dis[c[i<span class="hljs-number">-1</span>]][c[i]])*(<span class="hljs-number">1</span>-k[i]);
				<span class="hljs-keyword">if</span>(j+<span class="hljs-number">1</span>&lt;=n) a76+=(dis[d[j]][c[j+<span class="hljs-number">1</span>]])*(k[j]);
				<span class="hljs-keyword">if</span>(j+<span class="hljs-number">1</span>&lt;=n) a76+=(dis[c[j]][c[j+<span class="hljs-number">1</span>]])*(<span class="hljs-number">1</span>-k[j]);
				
				<span class="hljs-keyword">if</span>(i+<span class="hljs-number">1</span>==j)
				&#123;
					a76+=(dis[d[i]][d[j]])*(k[i]*k[j]);
					a76+=(dis[d[i]][c[j]])*(k[i]*(<span class="hljs-number">1</span>-k[j]));
					a76+=(dis[c[i]][d[j]])*((<span class="hljs-number">1</span>-k[i])*k[j]);
					a76+=(dis[c[i]][c[j]])*((<span class="hljs-number">1</span>-k[i])*(<span class="hljs-number">1</span>-k[j]));
				&#125;
				<span class="hljs-keyword">else</span>
				&#123;
					a76+=(dis[d[i]][c[i+<span class="hljs-number">1</span>]])*(k[i]);
					a76+=(dis[c[i]][c[i+<span class="hljs-number">1</span>]])*(<span class="hljs-number">1</span>-k[i]);
					a76+=(dis[c[j<span class="hljs-number">-1</span>]][d[j]])*(k[j]);
					a76+=(dis[c[j<span class="hljs-number">-1</span>]][c[j]])*(<span class="hljs-number">1</span>-k[j]);
				&#125;
				
				<span class="hljs-keyword">if</span>(i<span class="hljs-number">-1</span>&gt;=<span class="hljs-number">2</span>) a76+=<span class="hljs-built_in">query</span>(<span class="hljs-number">2</span>,i<span class="hljs-number">-1</span>);
				<span class="hljs-keyword">if</span>(j+<span class="hljs-number">2</span>&lt;=n) a76+=<span class="hljs-built_in">query</span>(j+<span class="hljs-number">2</span>,n);
				<span class="hljs-keyword">if</span>(i+<span class="hljs-number">2</span>&lt;=j<span class="hljs-number">-1</span>) a76+=<span class="hljs-built_in">query</span>(i+<span class="hljs-number">2</span>,j<span class="hljs-number">-1</span>);
				
				ans=<span class="hljs-built_in">min</span>(a76,ans);
			&#125;
		&#125;
	&#125;
	<span class="hljs-type">void</span> _100pts()
	&#123;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">0</span>;i&lt;=n;i++)
			<span class="hljs-keyword">for</span>(ll j=<span class="hljs-number">0</span>;j&lt;=m;j++)
				f[i][j][<span class="hljs-number">0</span>]=f[i][j][<span class="hljs-number">1</span>]=inf;
		f[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=f[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;<span class="hljs-comment">//刚开始的教室，无论换还是不换，都相当于不用跑路 </span>
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">2</span>;i&lt;=n;i++)
		&#123;
			add[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=dis[c[i<span class="hljs-number">-1</span>]][c[i]];
			add[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]=dis[c[i<span class="hljs-number">-1</span>]][c[i]]*(<span class="hljs-number">1</span>-k[i])+
					  dis[c[i<span class="hljs-number">-1</span>]][d[i]]*(k[i]);
			add[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=dis[c[i<span class="hljs-number">-1</span>]][c[i]]*(<span class="hljs-number">1</span>-k[i<span class="hljs-number">-1</span>])+
					  dis[d[i<span class="hljs-number">-1</span>]][c[i]]*(k[i<span class="hljs-number">-1</span>]);
			add[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]=dis[c[i<span class="hljs-number">-1</span>]][c[i]]*((<span class="hljs-number">1</span>-k[i<span class="hljs-number">-1</span>])*(<span class="hljs-number">1</span>-k[i]))+
					  dis[c[i<span class="hljs-number">-1</span>]][d[i]]*((<span class="hljs-number">1</span>-k[i<span class="hljs-number">-1</span>])*k[i])+
					  dis[d[i<span class="hljs-number">-1</span>]][c[i]]*(k[i<span class="hljs-number">-1</span>]*(<span class="hljs-number">1</span>-k[i]))+
					  dis[d[i<span class="hljs-number">-1</span>]][d[i]]*(k[i<span class="hljs-number">-1</span>]*k[i]);
			
			f[i][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=f[i<span class="hljs-number">-1</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]+add[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>];
			<span class="hljs-keyword">for</span>(ll j=<span class="hljs-number">1</span>;j&lt;=<span class="hljs-built_in">min</span>(m,i);j++)
			&#123;
				f[i][j][<span class="hljs-number">0</span>]=<span class="hljs-built_in">min</span>(f[i][j][<span class="hljs-number">0</span>],
						   <span class="hljs-built_in">min</span>(f[i<span class="hljs-number">-1</span>][j][<span class="hljs-number">0</span>]+add[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>],
							   f[i<span class="hljs-number">-1</span>][j][<span class="hljs-number">1</span>]+add[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]));
							   
				f[i][j][<span class="hljs-number">1</span>]=<span class="hljs-built_in">min</span>(f[i][j][<span class="hljs-number">1</span>],
						   <span class="hljs-built_in">min</span>(f[i<span class="hljs-number">-1</span>][j<span class="hljs-number">-1</span>][<span class="hljs-number">0</span>]+add[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>],
							   f[i<span class="hljs-number">-1</span>][j<span class="hljs-number">-1</span>][<span class="hljs-number">1</span>]+add[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]));
			&#125;
		&#125;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">0</span>;i&lt;=m;i++)
		&#123;
			ans=<span class="hljs-built_in">min</span>(ans,f[n][i][<span class="hljs-number">0</span>]);
			ans=<span class="hljs-built_in">min</span>(ans,f[n][i][<span class="hljs-number">1</span>]);
		&#125;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		ll t1,t2,t3;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld%lld%lld&quot;</span>,&amp;n,&amp;m,&amp;v,&amp;e);
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld&quot;</span>,c+i);
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld&quot;</span>,d+i);
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lf&quot;</span>,k+i);
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=v;i++)
			<span class="hljs-keyword">for</span>(ll j=<span class="hljs-number">1</span>;j&lt;=v;j++)
				<span class="hljs-keyword">if</span>(i!=j) dis[i][j]=inf;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=e;i++)
		&#123;
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld%lld&quot;</span>,&amp;t1,&amp;t2,&amp;t3);
			dis[t1][t2]=dis[t2][t1]=<span class="hljs-built_in">min</span>(dis[t1][t2],t3);
		&#125;
		<span class="hljs-keyword">for</span>(ll k=<span class="hljs-number">1</span>;k&lt;=v;k++)
			<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=v;i++)
				<span class="hljs-keyword">for</span>(ll j=<span class="hljs-number">1</span>;j&lt;=v;j++)
					dis[i][j]=<span class="hljs-built_in">min</span>(dis[i][j],dis[i][k]+dis[k][j]);
		_24pts();
		<span class="hljs-keyword">if</span>(m&gt;=<span class="hljs-number">1</span>) _52pts();
		<span class="hljs-keyword">if</span>(m&gt;=<span class="hljs-number">2</span>) _76pts();
		<span class="hljs-keyword">if</span>(m&gt;=<span class="hljs-number">3</span>) _100pts();
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.2lf\n&quot;</span>,ans);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>&#123;
	<span class="hljs-comment">//freopen(&quot;in.txt&quot;,&quot;r&quot;,stdin);</span>
	<span class="hljs-comment">//freopen(&quot;out.txt&quot;,&quot;w&quot;,stdout);</span>
	_yz::<span class="hljs-built_in">yzmain</span>();
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre></details><br><hr><br><blockquote><br>本文作者：xzy,fsl,mzf,Yurchiu<br><br>本文链接：https://yz-hs.github.io/b50c00ca3042/<br><br>版权声明：本博客中所有原创文章除特别声明外，均允许规范转载，转载请注明出处。所有非原创文章，按照原作者要求转载。<br><br></blockquote><br><div class="end-post-meta"><span><a href="/tags/OI"><i class="fa fa-tag"></i> OI</a></span> <span><a href="/tags/图论"><i class="fa fa-tag"></i> 图论</a></span> <span><a href="/tags/动态规划"><i class="fa fa-tag"></i> 动态规划</a></span> <span><a href="/tags/最短路"><i class="fa fa-tag"></i> 最短路</a></span> <span><a href="/tags/数学期望"><i class="fa fa-tag"></i> 数学期望</a></span></div><div class="end-post-meta"><span><i class="fa fa-refresh"></i> 最后更新：2023-08-21, 23:18:20</span></div></div><div class="prevnext"><a class="prev" href="/b48730b3eb5e/">上一页</a> <a class="next" href="/46fe69313ce6/">下一页</a></div><div class="comments"><div class="giscus"></div><script>function my_giscus_load(){var t=document.createElement("script");t.setAttribute("src","https://giscus.app/client.js"),t.setAttribute("data-repo","yz-hs/no-star"),t.setAttribute("data-repo-id","R_kgDOKHnuhg"),t.setAttribute("data-category","General"),t.setAttribute("data-category-id","DIC_kwDOKHnuhs4CYog9"),t.setAttribute("data-mapping","pathname"),t.setAttribute("data-strict","0"),t.setAttribute("data-reactions-enabled","1"),t.setAttribute("data-emit-metadata","0"),t.setAttribute("data-input-position","top"),t.setAttribute("data-theme","light"),4==readData("color")&&t.setAttribute("data-theme","dark"),t.setAttribute("data-lang","zh-CN"),t.setAttribute("data-loading","lazy"),t.setAttribute("crossorigin","anonymous"),t.setAttribute("async","true"),document.head.appendChild(t)}my_giscus_load()</script></div><div class="avatar-container" style="padding:50px"><img src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-avatar.jpg" class="avatar revolve" style="height:12%;width:12%"><div style="text-align:center;margin-top:3%">By Yurchiu.</div></div></div><div class="vertical toolbar"><div class="tab-page"><div class="tabTitle tb-tabTitle"><ul><li class="current"><i class="fa fa-random"></i></li><li><i class="fa fa-refresh"></i></li><li><i class="fa fa-circle-o-notch"></i></li></ul></div><div class="tabContent tb-tabContent"><div><div class="title">随机文章<span class="sidetitle">回味旧文</span></div><div class="item no-lrpadding"><a class="post-link" href="/d24d99489782/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">2020 新年贺词</div></div></a><a class="post-link" href="/3513c6ef3e31/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">2021，初中毕业</div></div></a><a class="post-link" href="/3f5d366e12dd/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">一个 4 人囚徒困境的必胜策略</div></div></a><a class="post-link" href="/501647d25831/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">AFO 有感</div></div></a><a class="post-link" href="/2ab979d324b5/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">BSGS 与 exBSGS</div></div></a><a class="post-link" href="/ed885af1fef5/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">ASCII 艺术</div></div></a><a class="post-link" href="/1ed002c31ce3/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">CSP-J1 游记</div></div></a></div></div><div class="hide"><div class="title">最近更新<span class="sidetitle">旧文更新</span></div><div class="item no-lrpadding"><a class="post-link" href="/942883c5ce30/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报 007》</div></div></a><a class="post-link" href="/32cc033936e2/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">[Theme] Readme</div></div></a><a class="post-link" href="/1f53cba6a83c/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报 10》</div></div></a><a class="post-link" href="/39e4c172e542/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">Cutie 使用文档</div></div></a><a class="post-link" href="/d3dec5d93e6e/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">欢迎</div></div></a><a class="post-link" href="/5f04cc136ab4/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报 6》</div></div></a><a class="post-link" href="/7a042de58116/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报 2》</div></div></a></div></div><div class="hide"><div class="title">其他物件<a data-bs-toggle="tooltip" href="javascript: document.body.contentEditable='true';
    document.designMode='on';void(0);" title="彩蛋：点击我，可以编辑本页面！" target="_self" class="sidetitle">杂物收纳</a></div><div style="height:10px"></div><div class="item"><tag style="display:inline-block">Hitokoto</tag><br><br><div id="hitokoto">Yurchiu 说，除了她以外的人都很强！嘤嘤嘤~~</div><script>fetch("https://v1.hitokoto.cn").then(function(t){return t.json()}).then(function(t){$("#hitokoto").html(t.hitokoto+"<br><br><div style='text-align: right;'>——"+t.from+"</div>")}).catch(function(t){console.error(t)})</script></div><div class="item"><div id="timeprogress"></div><script>var myDate=new Date,hours=myDate.getHours(),minutes=myDate.getMinutes(),pro=(minutes=60*hours+minutes)/14.4,innerhtml="        <div class='progress' style='height: 20px'>          <div data-bs-toggle='tooltip'               class='progress-bar'               title='时间已过去了 "+pro.toFixed(2)+"%'               style='width: "+pro+"%;               background: #4caf50; color: #fff;'>"+pro.toFixed(0)+"%          </div>        </div>";document.getElementById("timeprogress").innerHTML=innerhtml</script></div></div></div></div><div class="item"><div class="title">博客信息</div><div class="list-group"><div class="list-group-item"><div><i class="fa fa-file-text-o fa-fw"></i> 文章数目</div><div class="badge">158</div></div><div class="list-group-item"><div><i class="fa fa-refresh fa-fw"></i> 最近更新</div><div class="badge">08-21</div></div><div class="list-group-item"><div><i class="fa fa-font fa-fw"></i> 本站字数</div><div class="badge">345.4k</div></div></div></div><div class="post-toc"><div class="title">文章目录</div><div class="post-toc-inner"></div></div><script>tocbot.init({tocSelector:".post-toc-inner",contentSelector:".post-text",headingSelector:"h1, h2, h3, h4, h5, h6",hasInnerContainers:!0})</script><script>$(function(){var i=$(".tb-tabTitle>ul>li"),n=$(".tb-tabContent>div");i.click(function(){var t=$(this);setTimeout(function(){t.addClass("current").siblings().removeClass("current");var i=t.index();n.eq(i).show().siblings().hide()})})})</script></div></div><div class="footer"><p class="text-left">©2019-2023 <a target="_blank" rel="noopener" href="https://github.com/yz-hs">Yurchiu</a>. All rights reserved.</p><p class="text-right">Theme <a target="_blank" rel="noopener" href="https://github.com/yz-hs/cutie">Cutie</a>, by Yurchiu.</p></div><div class="natsuki-container" style="width:120px" data-bs-toggle="tooltip" title="Don't touch me! qwq"><img id="natsuki2" width="100%" height="100%" src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/natsuki2.png"> <img id="natsuki1" width="100%" height="100%" src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/natsuki1.png"></div><script type="text/javascript">$("#natsuki1").click(function(){$("#natsuki1").hide(),$("#natsuki2").show(),$("#natsuki2").css("animation","natsuki 0.55s cubic-bezier(0, 0, 0, 1)")}),$("#natsuki2").each(function(){$(this)[0].addEventListener("animationend",function(){$("#natsuki2").hide(),$("#natsuki1").show(),$(this).css("animation","")})})</script><script>readData("special")||$("html").addClass("none")</script><script>readData("color")||$("html").addClass("color-white"),4==readData("color")&&($("body").css("opacity","0.85"),$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/night-bgp.jpg)")),$("img").attr("onerror","this.src='https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/error.jpg';this.onerror=null"),initial()</script></div><meting-js class="meting-js appear" fixed="ture" server="netease" type="playlist" id="8524070964"></meting-js><script>consolePrint(),HideIt()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/custom/custom.css"><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/custom/custom.js"></script></body></html>