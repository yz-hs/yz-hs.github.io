<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="msvalidate.01" content="A7B4DB5A7BF5E5C6E52E34BB024D6319"><meta name="description" content="本站为 Yurchiu 用来记录 OI、笔记、感想的 Blog，欢迎来到本博客！希望我们能相互交流，共同进步～"><meta http-equiv="content-language" content="zh-cn"><title>Tarjan 算法 | Yurchiu's Blog</title><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.4.17/sweetalert2.all.min.js"></script><script src="https://cdn.staticfile.org/sketch.js/1.0/sketch.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/chaffle.min.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/core/main.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/core/search.js"></script><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/core/initialization.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.6/katex.min.css"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/vs2015.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/css/colors/std.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/css/colors/white.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/css/colors/night.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/css/colors/trans.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/css/special/special.css"><link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Yurchiu's Blog" type="application/atom+xml"></head><body style="background-image:url(https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-bgp.png)"><div id="YurLoading" class="YurLoading"><div class="inner"><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div><div class="line-wrap"><div class="line"></div></div></div></div><div class="topbar"><a onclick="topbarToggle()" class="topbar-menu" style="cursor:pointer"><i class="fa fa-bars"></i> </a><a href="/" class="topbar-title"><i class="fa fa-home"></i> Yurchiu's Blog </a><a target="_blank" rel="noopener" href="https://github.com/yz-hs" class="topbar-title"><i class="fa fa-github"></i></a></div><div id="article-container"><div class="sidebar"><div class="avatar-container"><img src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-avatar.jpg" class="avatar revolve"></div><div class="sidebar-author">Yurchiu<br><span class="mini-text">An AFO whker.</span></div><div class="sidebar-list-container"><div style="height:10px"></div><a class="list-group-item" href="/"><div><i class="fa fa-home fa-fw"></i>&nbsp; 首页</div><div class="badge"></div></a><a class="list-group-item" href="/archives/"><div><i class="fa fa-tasks fa-fw"></i>&nbsp; 归档</div><div class="badge">160</div></a><a class="list-group-item" href="/tags/"><div><i class="fa fa-tags fa-fw"></i>&nbsp; 标签</div><div class="badge">81</div></a><a class="list-group-item" href="/categories/"><div><i class="fa fa-th-large fa-fw"></i>&nbsp; 分类</div><div class="badge">24</div></a><a class="list-group-item" href="/somepage/mood/"><div><i class="fa fa-photo fa-fw"></i>&nbsp; 说说</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/about/"><div><i class="fa fa-user-o fa-fw"></i>&nbsp; 关于</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/chat/"><div><i class="fa fa-commenting-o fa-fw"></i>&nbsp; 留言</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/link/"><div><i class="fa fa-link fa-fw"></i>&nbsp; 链接</div><div class="badge"></div></a><a class="list-group-item" href="/somepage/settings/"><div><i class="fa fa-cog fa-fw"></i>&nbsp; 设置</div><div class="badge"></div></a><div style="height:200px"></div></div><div class="sidebar-footer"><div class="item" id="back2Top" data-bs-toggle="tooltip" title="顶部"><i class="fa fa-arrow-circle-up"></i></div><div class="item" id="back2Down" data-bs-toggle="tooltip" title="底部"><i class="fa fa-arrow-circle-down"></i></div><div class="item" data-bs-toggle="tooltip" title="RSS"><a href="/atom.xml"><i class="fa fa-feed"></i></a></div><div class="item" data-bs-toggle="tooltip" title="搜索"><a href="/somepage/search/"><i class="fa fa-search"></i></a></div></div></div><div class="article"><div class="vertical fake-sidebar"></div><div class="vertical post"><div class="header"><h1 class="title">Tarjan 算法</h1><div class="meta"><span><i class="fa fa-user-o"></i> Yurchiu </span><span><i class="fa fa-clock-o"></i> 2020-04-08, 18:52:19</span> <span><i class="fa fa-font"></i> 2.3k</span> <span class="hideBars" onclick="hideBars()"><i class="fa fa-eye-slash"></i> 隐藏左右两栏 </span><span class="showBars" onclick="showBars()"><i class="fa fa-eye"></i> 展示左右两栏</span></div></div><div class="breadcrumb"><div class="url"><a href="/"><i class="fa fa-home"></i> 首页</a> / Tarjan 算法</div><div class="share">分享到 <a target="_blank" rel="noopener" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://yz-hs.github.io/c9317a28769e/&title=Tarjan 算法&site=https://yz-hs.github.io"><i class="fa fa-qq"></i></a></div></div><div class="post-text"><p>Tarjan 算法是基于对图 dfs 的算法。时间复杂度一般为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>，因为边和点一般最多访问一次。</p><p style="font-size:45px;line-height:120%">退役的那场 NOIP，第三题需要边双连通分量缩点转化，不会写，警钟敲烂。希望后辈们基础要扎实。</p><p>转化完之后是简单 DP。<s>其实第三题就没好好想，考试完交流才发现第三题第二简单。</s></p><span id="more"></span><h1 id="强连通分量"><a class="markdownIt-Anchor" href="#强连通分量"></a> 强连通分量</h1><p><s>这个名字听起来很高大上。</s></p><p>注意，强连通分量是<strong>有向图</strong>中的定义。</p><h2 id="定义"><a class="markdownIt-Anchor" href="#定义"></a> 定义</h2><p>两个顶点强连通的定义：</p><blockquote><p>两点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">v_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">v_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 之间存在着 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">v_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">v_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的路径及 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">v_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">v_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的路径。</p></blockquote><p>强连通图的定义：</p><blockquote><p>如果有向图 G 的每两个顶点都强连通，称 G 是一个强连通图。</p></blockquote><p>强连通分量的定义：</p><blockquote><p>有向图的极大强连通子图，称为强连通分量（单个点也可是强连通分量）。</p></blockquote><p>意思就是说，这个子图应是最大的。</p><hr><p>以下图举例：</p><pre class="highlight"><code>[1]&lt;--[2]--&gt;[3]
 |     ^     ^
 v     |     |
[4]--&gt;[5]--&gt;[6]
</code></pre><p>顶点 1，2 是强连通的；分别由 1245，3，6 构成的子图都是这个图的强连通分量。</p><h2 id="求强连通分量"><a class="markdownIt-Anchor" href="#求强连通分量"></a> 求强连通分量</h2><p>Tarjan 算法是基于对图深度优先搜索的算法，每个强连通分量为搜索树中的一颗子树。</p><p>搜索时，把当前搜索树中未处理的节点加入一个堆栈，回溯时可以盘对栈顶到栈中的节点是否为一个强连通分量。</p><p>定义 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><msub><mi>n</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">dfn_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 为节点 u 搜索的次序编号（时间戳）。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>w</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">low_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 为节点 u 向子树方向能够追溯到的最早的时间戳。</p><p>由定义可以得出：</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>w</mi><mi>u</mi></msub><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>d</mi><mi>f</mi><msub><mi>n</mi><mi>v</mi></msub><mo separator="true">,</mo><mi>l</mi><mi>o</mi><msub><mi>w</mi><mi>u</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">low_u=\min(dfn_v,low_u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。其中，u 应为 v 的在 dfs 树上的父节点。</p><p>当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><msub><mi>n</mi><mi>u</mi></msub><mo>=</mo><mi>l</mi><mi>o</mi><msub><mi>w</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">dfn_u=low_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 时，以 u 为根的搜索子树上所有节点是一个强连通分量。</p><h2 id="code-实现"><a class="markdownIt-Anchor" href="#code-实现"></a> CODE 实现</h2><p>需以下变量：</p><pre class="highlight"><code class="cpp">dfn[N]<span class="hljs-comment">//时间戳。</span>
low[N]<span class="hljs-comment">//一个节点向子树方向能够追溯到的最早的时间戳。</span>
ins[N]<span class="hljs-comment">//是否在栈中</span>
stk[N]<span class="hljs-comment">//手工栈。注意，这个栈与系统栈不同。</span>
bel[N]<span class="hljs-comment">//一个节点从属于哪个强连通分量。</span>
top=<span class="hljs-number">0</span><span class="hljs-comment">//栈的顶部指针。</span>
scc=<span class="hljs-number">0</span><span class="hljs-comment">//强连通分量个数。</span>
index=<span class="hljs-number">0</span><span class="hljs-comment">//用来戳时间戳。</span>
</code></pre><p>主体 CODE：</p><pre class="highlight"><code class="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-type">int</span> now)</span>
</span>&#123;
	dfn[now]=low[now]=(++index);<span class="hljs-comment">//戳时间戳</span>
	ins[now]=<span class="hljs-number">1</span>;stk[++top]=now;<span class="hljs-comment">//打上入栈标记，入栈</span>
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=head[now];i;i=e[i].nxt)<span class="hljs-comment">//枚举算符</span>
	&#123;
		<span class="hljs-type">int</span> to=one.e[i].end;
		<span class="hljs-keyword">if</span>(!dfn[to])
			<span class="hljs-built_in">tarjan</span>(to),low[now]=<span class="hljs-built_in">min</span>(low[now],low[to]);
        <span class="hljs-comment">//进行dfs，并根据前文求low_u。</span>
		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(ins[to])
			low[now]=<span class="hljs-built_in">min</span>(low[now],dfn[to]);
        <span class="hljs-comment">//已经在栈中且访问过了，回溯，并根据前文求low_u。</span>
        
		<span class="hljs-keyword">else</span>&#123;<span class="hljs-comment">/*无实际用处*/</span>&#125;
	&#125;
	<span class="hljs-keyword">if</span>(dfn[now]==low[now])<span class="hljs-comment">//强连通分量增加了</span>
	&#123;
		scc++;
		<span class="hljs-keyword">do</span>&#123;
			<span class="hljs-type">int</span> tmp=stk[top];
			ins[tmp]=<span class="hljs-number">0</span>;bel[tmp]=scc;
		&#125;<span class="hljs-keyword">while</span>(now!=stk[top--]);<span class="hljs-comment">//弹栈</span>
	&#125;
&#125;

<span class="hljs-comment">//注意，一遍tarjan不一定遍历所有点，所以要tarjan所有未访问的点。</span>
<span class="hljs-comment">//用dfn[]判断是否访问。</span>
</code></pre><p>例题：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2341">P2341 [USACO03FALL][HAOI2006]受欢迎的牛 G</a>。</p><h1 id="割点"><a class="markdownIt-Anchor" href="#割点"></a> 割点</h1><h2 id="定义-2"><a class="markdownIt-Anchor" href="#定义-2"></a> 定义</h2><p>删掉一个节点及其相邻的边，使连通块个数加一。这个节点就是割点。</p><p>tarjan 也可以求割点。原理是看一个节点的后继是否“返祖”（通过另一条路径访问到这个节点的祖先）。如下图：</p><pre class="highlight"><code>[1]&lt;--[2]--&gt;[3]
 |     ^     ^
 v     |     |
[4]--&gt;[5]--&gt;[6]
</code></pre><p>节点 5 就是一个割点。因为她的后继 6 不能通过“返祖”与 5 联系。</p><p>那这个呢：</p><pre class="highlight"><code>[1]---[2]---[3]
 |     |     |
 |     |     |
[4]---[5]---[6]

//无向图
</code></pre><p>很明显没有。</p><h2 id="求割点"><a class="markdownIt-Anchor" href="#求割点"></a> 求割点</h2><p>首先选定一个根节点，从该根节点开始遍历整个图。</p><p>对于根节点，判断是不是割点很简单——计算其子树数量，如果有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span></span></span></span> 棵及以上的子树，就是割点。因为如果去掉这个点，这两棵子树就不能互相到达。</p><p>对于非根节点，若对于边 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span>，如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><msub><mi>n</mi><mi>u</mi></msub><mo>≤</mo><mi>l</mi><mi>o</mi><msub><mi>w</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">dfn_u \le low_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，说明 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span> 最早也是在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 节点及之后了，此时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 就是割点。</p><p>显然，如果节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 的所有孩子节点可以不通过父节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 而访问到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 的祖先节点，那么说明此时去掉节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 不影响图的连通性， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 就不是割点。</p><p>相反，如果节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 至少存在一个孩子顶点，必须通过父节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 才能访问到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 的祖先节点，那么去掉节点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 后，顶点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 的祖先节点和孩子节点就不连通了，说明 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span></span></span></span> 是一个割点。</p><h2 id="code实现"><a class="markdownIt-Anchor" href="#code实现"></a> CODE实现</h2><p>需以下变量：</p><pre class="highlight"><code class="cpp">cut[]<span class="hljs-comment">//割点标记数组</span>
dad<span class="hljs-comment">//选定的根节点</span>
dfn[]<span class="hljs-comment">//时间戳。</span>
low[]<span class="hljs-comment">//一个节点向子树方向能够追溯到的最早的时间戳。</span>
index=<span class="hljs-number">0</span><span class="hljs-comment">//用来戳时间戳。</span>
child=<span class="hljs-number">0</span><span class="hljs-comment">//根节点子树数量</span>
</code></pre><p>主体 CODE：</p><pre class="highlight"><code class="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-type">int</span> now)</span>
</span>&#123;
	<span class="hljs-type">int</span> child=<span class="hljs-number">0</span>;
	dfn[now]=low[now]=(++index);
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=head[now];i;i=e[i].nxt)
	&#123;
		<span class="hljs-type">int</span> to=e[i].end;
		<span class="hljs-keyword">if</span>(!dfn[to])
		&#123;
			<span class="hljs-built_in">tarjan</span>(to);
			low[now]=<span class="hljs-built_in">min</span>(low[now],low[to]);
			<span class="hljs-keyword">if</span>(low[to]&gt;=dfn[now]&amp;&amp;now!=dad)
				cut[now]=<span class="hljs-number">1</span>;
			<span class="hljs-keyword">if</span>(now==dad) child++;
		&#125;
		<span class="hljs-keyword">else</span> low[now]=<span class="hljs-built_in">min</span>(low[now],dfn[to]);
	&#125;
	<span class="hljs-keyword">if</span>(child&gt;=<span class="hljs-number">2</span>&amp;&amp;now==dad)
		cut[now]=<span class="hljs-number">1</span>;
&#125;
</code></pre><p>例题：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3388">P3388 【模板】割点（割顶）</a></p><h1 id="割边桥"><a class="markdownIt-Anchor" href="#割边桥"></a> 割边（桥）</h1><h2 id="定义-3"><a class="markdownIt-Anchor" href="#定义-3"></a> 定义</h2><p>删掉一条边，使连通块个数加一。这个边就是割边（桥）。</p><p>割点与桥（割边）的关系：</p><ol><li><p>有割点不一定有桥,有桥一定存在割点</p></li><li><p>桥一定是割点依附的边。</p></li></ol><h2 id="求割边"><a class="markdownIt-Anchor" href="#求割边"></a> 求割边</h2><p>与求割点类似。$low_v &gt; dfn_u $ 就说明 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span> 是桥。</p><h2 id="code-实现-2"><a class="markdownIt-Anchor" href="#code-实现-2"></a> CODE 实现</h2><p>与求割点类似：</p><pre class="highlight"><code class="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(<span class="hljs-type">int</span> now,<span class="hljs-type">int</span> dad)</span><span class="hljs-comment">//规避儿子访问父亲的情况出现。</span>
</span>&#123;
	dfn[now]=low[now]=(++index);
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=head[now];i;i=e[i].nxt)
	&#123;
		<span class="hljs-type">int</span> to=e[i].end;
		<span class="hljs-keyword">if</span>(!dfn[to])
		&#123;
			<span class="hljs-built_in">tarjan</span>(to,now);
			low[now]=<span class="hljs-built_in">min</span>(low[now],low[to]);
			<span class="hljs-keyword">if</span>(low[to]&gt;dfn[now]) cut[now]=<span class="hljs-number">1</span>;
		&#125;
		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(to!=dad) low[now]=<span class="hljs-built_in">min</span>(low[now],dfn[to]);
	&#125;
&#125;

<span class="hljs-comment">//割点无需规避儿子访问父亲的情况出现，原因：不影响判断。</span>
</code></pre><h1 id="缩点"><a class="markdownIt-Anchor" href="#缩点"></a> 缩点</h1><p>指将强连通分量看作一个点。</p><h2 id="code-实现-3"><a class="markdownIt-Anchor" href="#code-实现-3"></a> CODE 实现</h2><pre class="highlight"><code class="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">build</span><span class="hljs-params">()</span>
</span>&#123;
	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> now=<span class="hljs-number">1</span>;now&lt;=n;now++)
	&#123;
		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=big.head[now];j;j=big.e[j].nxt)
		&#123;
			<span class="hljs-type">int</span> to=big.e[j].end;
			<span class="hljs-keyword">if</span>(bel[now]==bel[to])
				<span class="hljs-keyword">continue</span>;
			small.<span class="hljs-built_in">add</span>(bel[now],bel[to]);
		&#125;
	&#125;
&#125;

<span class="hljs-comment">//big指原图，small指新图</span>
</code></pre><h1 id="例题"><a class="markdownIt-Anchor" href="#例题"></a> 例题</h1><h2 id="p1262-间谍网络"><a class="markdownIt-Anchor" href="#p1262-间谍网络"></a> P1262 间谍网络</h2><ul><li>如果 A 间谍手中掌握着关于 B 间谍的犯罪证据，则称 A 可以揭发 B。</li><li>有些间谍收受贿赂，只要给他们一定数量的美元，他们就愿意交出手中掌握的全部情报。</li><li>一旦我们逮捕了一个间谍，他手中掌握的情报都将归我们所有，这样就有可能逮捕新的间谍，掌握新的情报。</li><li>我们已知所有受贿的间谍，以及他们愿意收受的具体数额。同时我们还知道哪些间谍手中具体掌握了哪些间谍的资料。</li></ul><p>总共有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> 个间谍（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> 不超过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3000</mn></mrow><annotation encoding="application/x-tex">3000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span>）。判断我们是否有可能控制全部的间谍，如果可以，求出我们所需要支付的最少资金。否则，输出不能被控制的一个间谍。</p><p><strong>缩点+拓扑排序</strong>。参考代码：</p><details><summary>点击查看</summary><pre class="highlight"><code class="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
<span class="hljs-keyword">namespace</span> _yz
&#123;
	<span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> ll;
	<span class="hljs-type">const</span> ll N=<span class="hljs-number">3000</span>+<span class="hljs-number">10</span>,inf=<span class="hljs-number">2147483647</span>;
	<span class="hljs-keyword">struct</span> <span class="hljs-title class_">graph</span>
	&#123;
		<span class="hljs-keyword">struct</span> <span class="hljs-title class_">edge</span>&#123;ll nxt,to;&#125;e[N*<span class="hljs-number">2</span>];
		ll head[N],cnt,w[N],num[N],in[N];
		<span class="hljs-built_in">graph</span>()
		&#123;
			<span class="hljs-built_in">memset</span>(head,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(head));
			<span class="hljs-built_in">memset</span>(e,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(e));
			<span class="hljs-built_in">memset</span>(in,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(in));
			<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=N<span class="hljs-number">-1</span>;i++) w[i]=num[i]=inf;
			cnt=<span class="hljs-number">0</span>;
		&#125;
		<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(ll a,ll b)</span>
		</span>&#123;
			e[++cnt]=(edge)&#123;head[a],b&#125;;
			head[a]=cnt;in[b]++;
		&#125;
	&#125;one,two;
	ll n,p,r,ans=<span class="hljs-number">0</span>,fail=inf;
	ll ins[N],stk[N],dfn[N],low[N],bel[N],scc=<span class="hljs-number">0</span>,index=<span class="hljs-number">0</span>,top=<span class="hljs-number">0</span>;
	queue&lt;ll&gt;q;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">tarjan</span><span class="hljs-params">(ll now)</span>
	</span>&#123;
		dfn[now]=low[now]=++index;
		stk[++top]=now;ins[now]=<span class="hljs-number">1</span>;
		<span class="hljs-keyword">for</span>(ll i=one.head[now];i;i=one.e[i].nxt)
		&#123;
			ll to=one.e[i].to;
			<span class="hljs-keyword">if</span>(!dfn[to])
			&#123;
				<span class="hljs-built_in">tarjan</span>(to);
				low[now]=<span class="hljs-built_in">min</span>(low[now],low[to]);
			&#125;
			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(ins[to])
			&#123;
				low[now]=<span class="hljs-built_in">min</span>(low[now],dfn[to]);
			&#125;
		&#125;
		<span class="hljs-keyword">if</span>(dfn[now]==low[now])
		&#123;
			scc++;
			<span class="hljs-keyword">do</span>&#123;
				ll cur=stk[top];
				bel[cur]=scc;
				<span class="hljs-keyword">if</span>(two.w[scc]&gt;=one.w[cur])
				&#123;
					two.w[scc]=one.w[cur];
					two.num[scc]=<span class="hljs-built_in">min</span>(two.num[scc],one.num[cur]);
				&#125;
				ins[cur]=<span class="hljs-number">0</span>;
			&#125;<span class="hljs-keyword">while</span>(stk[top--]!=now);
		&#125;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">build</span><span class="hljs-params">(ll now)</span>
	</span>&#123;
		<span class="hljs-keyword">for</span>(ll i=one.head[now];i;i=one.e[i].nxt)
		&#123;
			ll to=one.e[i].to;
			<span class="hljs-keyword">if</span>(bel[now]!=bel[to])
				two.<span class="hljs-built_in">add</span>(bel[now],bel[to]);
		&#125;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">fake_topo</span><span class="hljs-params">()</span>
	</span>&#123;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=scc;i++)
		&#123;
			<span class="hljs-keyword">if</span>(two.in[i]==<span class="hljs-number">0</span>)
				q.<span class="hljs-built_in">push</span>(i);
		&#125;
		<span class="hljs-keyword">while</span>(!q.<span class="hljs-built_in">empty</span>())
		&#123;
			ll now=q.<span class="hljs-built_in">front</span>();
			q.<span class="hljs-built_in">pop</span>();
			<span class="hljs-keyword">if</span>(two.w[now]==inf)
				fail=<span class="hljs-built_in">min</span>(fail,two.num[now]);
			ans+=two.w[now];
		&#125;
	&#125;
	<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">yzmain</span><span class="hljs-params">()</span>
	</span>&#123;
		ll t1,t2;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld&quot;</span>,&amp;n,&amp;p);
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=p;i++)
		&#123;
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld&quot;</span>,&amp;t1,&amp;t2);
			one.w[t1]=t2; 
		&#125;
		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld&quot;</span>,&amp;r);
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=r;i++)
		&#123;
			<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld&quot;</span>,&amp;t1,&amp;t2);
			one.<span class="hljs-built_in">add</span>(t1,t2);
		&#125;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++)
			one.num[i]=i;
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++)
			<span class="hljs-keyword">if</span>(!dfn[i]) <span class="hljs-built_in">tarjan</span>(i);
		<span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=n;i++)
			<span class="hljs-built_in">build</span>(i);
		<span class="hljs-built_in">fake_topo</span>();
		<span class="hljs-keyword">if</span>(fail!=inf)
		&#123;
			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;NO\n%lld\n&quot;</span>,fail);
			<span class="hljs-keyword">return</span>;
		&#125;
		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;YES\n%lld\n&quot;</span>,ans);
		<span class="hljs-keyword">return</span>;
	&#125;
&#125;
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>&#123;
	_yz::<span class="hljs-built_in">yzmain</span>();
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;
</code></pre></details><br><hr><br><blockquote><br>本文作者：Yurchiu<br><br>本文链接：https://yz-hs.github.io/c9317a28769e/<br><br>版权声明：本博客中所有原创文章除特别声明外，均允许规范转载，转载请注明出处。所有非原创文章，按照原作者要求转载。<br><br></blockquote><br><div class="end-post-meta"><span><a href="/tags/OI"><i class="fa fa-tag"></i> OI</a></span> <span><a href="/tags/图论"><i class="fa fa-tag"></i> 图论</a></span> <span><a href="/tags/强连通分量"><i class="fa fa-tag"></i> 强连通分量</a></span></div><div class="end-post-meta"><span><i class="fa fa-refresh"></i> 最后更新：2023-08-18, 10:52:56</span></div></div><div class="prevnext"><a class="prev" href="/f4829e127292/">上一页</a> <a class="next" href="/ed885af1fef5/">下一页</a></div><div class="comments"><div class="giscus"></div><script>function my_giscus_load(){var t=document.createElement("script");t.setAttribute("src","https://giscus.app/client.js"),t.setAttribute("data-repo","yz-hs/no-star"),t.setAttribute("data-repo-id","R_kgDOKHnuhg"),t.setAttribute("data-category","General"),t.setAttribute("data-category-id","DIC_kwDOKHnuhs4CYog9"),t.setAttribute("data-mapping","pathname"),t.setAttribute("data-strict","0"),t.setAttribute("data-reactions-enabled","1"),t.setAttribute("data-emit-metadata","0"),t.setAttribute("data-input-position","top"),t.setAttribute("data-theme","light"),4==readData("color")&&t.setAttribute("data-theme","dark"),t.setAttribute("data-lang","zh-CN"),t.setAttribute("data-loading","lazy"),t.setAttribute("crossorigin","anonymous"),t.setAttribute("async","true"),document.head.appendChild(t)}my_giscus_load()</script></div><div class="avatar-container" style="padding:50px"><img src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/new-avatar.jpg" class="avatar revolve" style="height:12%;width:12%"><div style="text-align:center;margin-top:3%">By Yurchiu.</div></div></div><div class="vertical toolbar"><div class="tab-page"><div class="tabTitle tb-tabTitle"><ul><li class="current"><i class="fa fa-random"></i></li><li><i class="fa fa-refresh"></i></li><li><i class="fa fa-circle-o-notch"></i></li></ul></div><div class="tabContent tb-tabContent"><div><div class="title">随机文章<span class="sidetitle">回味旧文</span></div><div class="item no-lrpadding"><a class="post-link" href="/d24d99489782/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">2020 新年贺词</div></div></a><a class="post-link" href="/ed885af1fef5/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">ASCII 艺术</div></div></a><a class="post-link" href="/501647d25831/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">AFO 有感</div></div></a><a class="post-link" href="/3513c6ef3e31/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">2021，初中毕业</div></div></a><a class="post-link" href="/3f5d366e12dd/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">一个 4 人囚徒困境的必胜策略</div></div></a><a class="post-link" href="/2ab979d324b5/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">BSGS 与 exBSGS</div></div></a><a class="post-link" href="/1ed002c31ce3/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">CSP-J1 游记</div></div></a></div></div><div class="hide"><div class="title">最近更新<span class="sidetitle">旧文更新</span></div><div class="item no-lrpadding"><a class="post-link" href="/6515fc8a93b1/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">《幽默报》</div></div></a><a class="post-link" href="/ed885af1fef5/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">ASCII 艺术</div></div></a><a class="post-link" href="/30b17991ae72/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">【解析几何】等效判别式</div></div></a><a class="post-link" href="/4d8f0cef397c/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">【解析几何】仿射变换</div></div></a><a class="post-link" href="/0e3f9acc1e28/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">【解析几何】齐次化联立</div></div></a><a class="post-link" href="/b5c9603ceb3e/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">【空间向量】叉积</div></div></a><a class="post-link" href="/2565dbc61d2c/"><div class="title_fa"><i class="fa fa-file-text-o fa-border" style="height:30px;border:none"></i><div class="title">NOIP-2021 有感</div></div></a></div></div><div class="hide"><div class="title">其他物件<a data-bs-toggle="tooltip" href="javascript: document.body.contentEditable='true';
    document.designMode='on';void(0);" title="彩蛋：点击我，可以编辑本页面！" target="_self" class="sidetitle">杂物收纳</a></div><div style="height:10px"></div><div class="item"><tag style="display:inline-block">Hitokoto</tag><br><br><div id="hitokoto">Yurchiu 说，除了她以外的人都很强！嘤嘤嘤~~</div><script>fetch("https://v1.hitokoto.cn").then(function(t){return t.json()}).then(function(t){$("#hitokoto").html(t.hitokoto+"<br><br><div style='text-align: right;'>——"+t.from+"</div>")}).catch(function(t){console.error(t)})</script></div><div class="item"><div id="timeprogress"></div><script>var myDate=new Date,hours=myDate.getHours(),minutes=myDate.getMinutes(),pro=(minutes=60*hours+minutes)/14.4,innerhtml="        <div class='progress' style='height: 20px'>          <div data-bs-toggle='tooltip'               class='progress-bar'               title='时间已过去了 "+pro.toFixed(2)+"%'               style='width: "+pro+"%;               background: #4caf50; color: #fff;'>"+pro.toFixed(0)+"%          </div>        </div>";document.getElementById("timeprogress").innerHTML=innerhtml</script></div></div></div></div><div class="item"><div class="title">博客信息</div><div class="list-group"><div class="list-group-item"><div><i class="fa fa-file-text-o fa-fw"></i> 文章数目</div><div class="badge">160</div></div><div class="list-group-item"><div><i class="fa fa-refresh fa-fw"></i> 最近更新</div><div class="badge">08-18</div></div><div class="list-group-item"><div><i class="fa fa-font fa-fw"></i> 本站字数</div><div class="badge">341.2k</div></div></div></div><div class="post-toc"><div class="title">文章目录</div><div class="post-toc-inner"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F"><span class="toc-text">强连通分量</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%B2%E7%82%B9"><span class="toc-text">割点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%B2%E8%BE%B9%E6%A1%A5"><span class="toc-text">割边（桥）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%A9%E7%82%B9"><span class="toc-text">缩点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-text">例题</span></a></li></ol></div></div><script>$(function(){var i=$(".tb-tabTitle>ul>li"),n=$(".tb-tabContent>div");i.click(function(){var t=$(this);setTimeout(function(){t.addClass("current").siblings().removeClass("current");var i=t.index();n.eq(i).show().siblings().hide()})})})</script></div></div><div class="footer"><p class="text-left">©2019-2023 <a target="_blank" rel="noopener" href="https://github.com/yz-hs">Yurchiu</a>. All rights reserved.</p><p class="text-right">Theme <a target="_blank" rel="noopener" href="https://github.com/yz-hs/cutie">Cutie</a>, by Yurchiu.</p></div><div class="natsuki-container" style="width:120px" data-bs-toggle="tooltip" title="Don't touch me! qwq"><img id="natsuki2" width="100%" height="100%" src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/natsuki2.png"> <img id="natsuki1" width="100%" height="100%" src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/natsuki1.png"></div><script type="text/javascript">$("#natsuki1").click(function(){$("#natsuki1").hide(),$("#natsuki2").show(),$("#natsuki2").css("animation","natsuki 0.55s cubic-bezier(0, 0, 0, 1)")}),$("#natsuki2").each(function(){$(this)[0].addEventListener("animationend",function(){$("#natsuki2").hide(),$("#natsuki1").show(),$(this).css("animation","")})})</script><script>readData("special")||$("html").addClass("none")</script><script>readData("color")||$("html").addClass("color-white"),4==readData("color")&&($("body").css("opacity","0.85"),$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/night-bgp.jpg)")),$("img").attr("onerror","this.src='https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/img/error.jpg';this.onerror=null"),initialization()</script></div><meting-js class="meting-js appear" fixed="ture" server="netease" type="playlist" id="8524070964"></meting-js><script>consolePrint(),HideIt()</script><style type="text/css">.effect{position:fixed;left:0;top:0;z-index:99999;pointer-events:none}</style><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/ctitle.js"></script><div id="clickCanvas" class="effect"></div><script src="https://cdn.jsdelivr.net/gh/yz-hs/yz-hs.github.io/js/clickple.js"></script></body></html>